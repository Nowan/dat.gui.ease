{"version":3,"sources":["webpack://datGuiEase/webpack/universalModuleDefinition","webpack://datGuiEase/./src/EaseManager.js","webpack://datGuiEase/./src/gui/addEaseGUI.js","webpack://datGuiEase/./src/gui/controller/GUIController.js","webpack://datGuiEase/./src/gui/model/GUIModel.js","webpack://datGuiEase/./src/gui/model/ease/Ease.js","webpack://datGuiEase/./src/gui/model/ease/composites/Anchor.js","webpack://datGuiEase/./src/gui/model/ease/composites/Handle.js","webpack://datGuiEase/./src/gui/model/ease/composites/Point.js","webpack://datGuiEase/./src/gui/model/ease/exceptions/InvalidSVGPathException.js","webpack://datGuiEase/./src/gui/model/preset/EasePreset.js","webpack://datGuiEase/./src/gui/model/preset/EasePresetProps.js","webpack://datGuiEase/./src/gui/model/preset/EasePresetProvider.js","webpack://datGuiEase/./src/gui/model/preset/enum/Curve.js","webpack://datGuiEase/./src/gui/model/preset/enum/Orientation.js","webpack://datGuiEase/./src/gui/model/preset/presets.js","webpack://datGuiEase/./src/gui/view/GUIView.js","webpack://datGuiEase/./src/gui/view/GUIViewEvent.js","webpack://datGuiEase/./src/gui/view/HTMLElementDirector.js","webpack://datGuiEase/./src/gui/view/dom/directors/CurveSelectorDirector.js","webpack://datGuiEase/./src/gui/view/dom/directors/EaseEditorDirector.js","webpack://datGuiEase/./src/gui/view/dom/directors/EasePanelBackgroundDirector.js","webpack://datGuiEase/./src/gui/view/dom/directors/EasePanelDirector.js","webpack://datGuiEase/./src/gui/view/dom/directors/EasePropertiesDirector.js","webpack://datGuiEase/./src/gui/view/dom/directors/OrientationSelectorDirector.js","webpack://datGuiEase/./src/gui/view/dom/selectors.js","webpack://datGuiEase/./src/gui/view/editor/EaseEditor.js","webpack://datGuiEase/./src/gui/view/editor/events/EditorCurveChangeEvent.js","webpack://datGuiEase/./src/gui/view/editor/lib/curvesjs/BezierPoint.js","webpack://datGuiEase/./src/gui/view/editor/lib/curvesjs/Curve.js","webpack://datGuiEase/./src/gui/view/editor/lib/curvesjs/Point.js","webpack://datGuiEase/./src/index.js","webpack://datGuiEase/./src/middleware/Middleware.js","webpack://datGuiEase/./src/middleware/cast/CastEntry.js","webpack://datGuiEase/./src/middleware/cast/InstanceCastEntry.js","webpack://datGuiEase/./src/middleware/cast/PredicateCastEntry.js","webpack://datGuiEase/./src/middleware/cast/TransformCastEntry.js","webpack://datGuiEase/./node_modules/bezier-js/dist/bezier.cjs","webpack://datGuiEase/./src/gui/view/dom/gui.html","webpack://datGuiEase/./src/gui/view/dom/property.html","webpack://datGuiEase/./src/index.scss","webpack://datGuiEase/external {\"commonjs\":\"dat.gui\",\"commonjs2\":\"dat.gui\",\"amd\":\"dat.gui\",\"root\":\"dat\"}","webpack://datGuiEase/webpack/bootstrap","webpack://datGuiEase/webpack/runtime/define property getters","webpack://datGuiEase/webpack/runtime/hasOwnProperty shorthand","webpack://datGuiEase/webpack/runtime/make namespace object","webpack://datGuiEase/webpack/startup"],"names":["EaseManager","_middlewares","ease","some","middleware","isFormatSupported","find","Middleware","checkSignature","push","console","warn","dom","dat","addEaseGUI","object","property","controller","GUIController","_recallSavedValue","li","_addRow","addClass","appendChild","domElement","_augmentController","__controllers","DEFAULT_PRESET_NAME","gui","root","getRoot","matchedIndex","__rememberedObjects","indexOf","controllerMap","__rememberedObjectIndecesToControllers","undefined","load","remembered","presetMap","preset","value","initialValue","setValue","document","createElement","__ul","onResize","__li","__gui","name","querySelector","innerHTML","listen","remove","__preset_select","onValueModified","_markPresetModified","bind","modified","opt","selectedIndex","arguments","rawEase","_middleware","_model","GUIModel","_view","GUIView","curves","activePreset","setOrientations","getCurveOrientations","curve","setPreset","isEditingSupported","showEditButton","on","GUIViewEvent","CURVE_PRESET_SELECTED","_onCurvePresetSelected","ORIENTATION_PRESET_SELECTED","_onOrientationPresetSelected","CONFIG_PROPERTY_MODIFIED","_onConfigPropertyModified","EDIT_EASE_CLICKED","_onEditEaseClicked","EASE_MODIFIED","_onEaseModified","ACCEPT_EASE_EDIT_CLICKED","_onAcceptEaseEditClicked","DISCARD_EASE_EDIT_CLICKED","_onDiscardEaseEditClicked","_onValueModified","toString","easeSvgPath","Ease","fromSVGPath","matchingPreset","getPresetMatchingEase","EasePreset","CURVE","CUSTOM","ORIENTATION","NONE","_applyRevertedValue","callback","externalEase","__onChange","call","__onFinishChange","updateDisplay","nextCurve","currentOrientation","orientation","nextOrientations","nextOrientation","includes","nextPreset","getMatchingPreset","_applyValue","propertyName","propertyValue","log","preEditPreset","clone","openEditor","modifiedEase","closeEditor","controllers","Controller","_presets","presets","_curves","_extractCurves","_orientationsMap","_extractOrientationsPerCurveMap","_activePreset","_preEditPreset","get","equals","reduce","orientationsMap","Map","curveMatchingPresets","filter","orientations","map","set","anchors","_anchors","Array","from","length","toSVGPath","points","i","startAnchor","endAnchor","toPoint","handle","t","findBezierSegment","segmentStartAnchor","segmentEndAnchor","segmentT","x","toFixed","segmentAnchor","y","segmentBezier","Bezier","segmentBezierStep","intersects","p1","p2","shift","svgPath","anchor","Anchor","of","trimmedPath","trim","match","splice","safeParseCoordinate","startX","startY","cCoords","replace","split","Error","ofOriginAndHandle","Point","a","lastAnchor","slice","e","InvalidSVGPathException","path","firstAnchor","originPoint","path2","point","progress","rawCoordinate","coordinate","Number","parseFloat","NaN","Handle","ofOrigin","copy","originPointLike","handlePointLike","pointLike","easeOrSvgPath","UNDEFINED","ofSVGPath","props","EasePresetProps","entries","add","defaultValue","watcherFn","Curve","Orientation","_preset","_watchers","watchFn","has","EasePresetProvider","providerFunction","_providerFunction","_curveAlias","_orientationAlias","_props","curveAlias","Object","freeze","LINEAR","SINE","QUAD","CUBIC","QUART","QUINT","EXPO","CIRC","BACK","ELASTIC","BOUNCE","IN","OUT","IN_OUT","Linear","ofSample","SineIn","SineOut","SineInOut","QuadIn","QuadOut","QuadInOut","CubicIn","CubicOut","CubicInOut","QuartIn","QuartOut","QuartInOut","ExpoIn","ExpoOut","ExpoInOut","CircIn","CircOut","CircInOut","BackIn","BackOut","BackInOut","_renderTemplate","domTemplate","_easePanelDirector","EasePanelDirector","_element","_easePropertiesDirector","EasePropertiesDirector","_easeEditorDirector","args","emit","values","_isEditorOpen","initialEase","classList","EaseEditorDirector","cleanUp","HTMLElementDirector","template","DOMParser","parseFromString","body","firstChild","htmlElement","eventKey","addEventListener","event","detail","dispatchEvent","CustomEvent","CurveSelectorDirector","rootDomElement","_composeOptions","option","options","onchange","Option","_createCustomCurveOption","customCurveOption","setAttribute","_editor","EaseEditor","EditorCurveChangeEvent","KEY","_svgPathInspector","_initSvgPathInspector","_copyButton","_initCopyButton","_acceptButton","_initAcceptButton","_discardButton","_initDiscardButton","canvas","canvasClone","cloneNode","parentNode","replaceChild","inspectorElement","oninput","svgPathInspectorElement","buttonElement","onclick","select","execCommand","info","EasePanelBackgroundDirector","_cornerCurveCanvas","width","height","_cornerCurveCanvasContext","getContext","ctx","strokeStyle","fillStyle","lineWidth","clearRect","beginPath","moveTo","bezierCurveTo","lineTo","stroke","fill","_curveSelector","_orientationSelector","OrientationSelectorDirector","_background","_editButtonElement","style","display","refresh","StringController","NumberController","NumberControllerBox","BooleanController","createDatGuiController","propertyElement","propertyDomTemplate","className","firstElementChild","append","onChange","arg1","arg2","config","removeAttribute","easePanel","curveSelector","orientationSelector","cornerCurveCanvas","editButton","propertiesContainer","editorCanvas","editorSvgPathInspector","editorSvgPathCopyButton","editorAcceptButton","editorDeclineButton","_canvas","_ctx","_prepareContext","_curve","_createCurveJSInstance","_propagateEvents","cw","ch","startPoint","addAnchor","_fromCanvasX","position","_fromCanvasY","cp2","endPoint","cp1","pointColor","pointSize","cpDist","firstPoint","BezierPoint","_toCanvasX","_toCanvasY","precedingCurveEndAnchor","followingCurveStartAnchor","lastPoint","draw","clientWidth","clientHeight","CurveJS","setPointStyle","setLineStyle","_round","coord","numberOfFloatDigits","power","Math","pow","round","context","color","size","r","collapsed","v1x","v1y","v2x","v2y","interval","lineColor","mouseX","mouseY","events","canvasEvents","createLUT","frame","tolerance","iMin","iMax","key","xTarget","xCurrent","lookupX","abs","lookupY","pct","func","dist","dragReady","dragCP","draging","_this","evt","bbox","getBoundingClientRect","clientX","left","clientY","top","p","sqrt","cursor","keys","deltaW","deltaH","posX","floor","posY","move","temp","ondrag","onmousemove","preventDefault","addPoint","onnewpoint","offsetX","offsetY","collapse","ontogglecontrol","onremovepoint","sort","b","pP","window","keyCode","arc","PI","closePath","easeManager","addEase","hasCompatibleMiddleware","getCompatibleMiddleware","extend","GUI","prototype","addOverride","castEntries","_name","_castEntries","castEntry","TransformCastEntry","entry","thirdPartyEaseOrPredicateFunction","followupArguments","_predicatePreset","_instancePreset","thirdPartyEaseOrPredicate","predicateFunction","thirdPartyToNativeCast","nativeToThirdPartyCast","transform","thirdPartyEase","supportsCastInward","castInward","nativeEase","supportsCastOutward","castOutward","nativeEasePreset","PredicateCastEntry","InstanceCastEntry","instanceLike","test","CastEntry","nativeEasePresetOrPresetProvider","_thirdPartyEase","_parseNativePreset","rawNativePreset","next","_predicate","_transformThirdPartyToNativeEase","_transformNativeToThirdPartyEase"],"mappings":"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KiB,UAAL,CAAgBjB,cAAhB,KAAmC,KAAKkB,gCAA/C;AACH;;;aAED,oBAAWlB,cAAX,EAA2B;AACvB,eAAO,IAAIva,sBAAJ,CAAe,KAAKyb,gCAAL,CAAsClB,cAAtC,CAAf,EAAsE1S,kBAAM3H,MAA5E,CAAP;AACH;;;aAED,qBAAY2a,gBAAZ,EAA8B;AAC1B,eAAO,KAAKa,gCAAL,CAAsCb,gBAAgB,CAAC/gB,IAAvD,CAAP;AACH;;;aAED,YAAUqgB,iBAAV,EAA6BC,sBAA7B,EAAqDC,sBAArD,EAA6E;AACzE,0BAAWT,kBAAX,6BAAiClc,SAAjC;AACH;;;;IAvB4Bwd,sB;;iBA0BlBtB,kB;;;;;;;;;;;;;AC7BF;;AAEb,8CAA6C;AAC7C;AACA,CAAC,EAAC;AACF,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,QAAQ;;AAET;AACA;AACA,CAAC;;;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB;;AAEnB;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,KAAK;;;AAGL;;AAEA;AACA,qBAAqB,sBAAsB;AAC3C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;;AAEV;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA,iDAAiD,OAAO;AACxD;;AAEA,0BAA0B,OAAO;AACjC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA,sBAAsB,SAAS;AAC/B;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,sCAAsC,SAAS;AAC/C;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;;AAGT;AACA,OAAO;;;AAGP;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA,KAAK;;;AAGL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kBAAkB;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,qCAAqC;;AAErC;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;;AAEA,iCAAiC,SAAS;AAC1C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;;AAElC;AACA;AACA;AACA,UAAU;;;AAGV;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,mBAAmB,cAAc;AACjC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,yCAAyC,WAAW;AACpD;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,8BAA8B;;AAE9B;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;;AAEA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;;AAExB;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,MAAM;;AAEN;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,oCAAoC,UAAU;AAC9C;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB;AACnB;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,mBAAmB;;AAEnB;AACA;;AAEA,yBAAyB,WAAW;AACpC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,6BAA6B,gBAAgB;AAC7C;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA;;AAEA,eAAe,eAAe;AAC9B;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,4BAA4B,OAAO;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;;AAEf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb,sJAAsJ;;AAEtJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;;AAGL;AACA;;AAEA,2CAA2C,OAAO;AAClD;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA,MAAM;;AAEN;AACA;AACA;AACA,8DAA8D;;AAE9D;AACA;AACA,KAAK;;;AAGL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;;AAEnB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,gCAAgC,oBAAoB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;;AAEA;AACA,4BAA4B,gBAAgB;AAC5C;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA,0CAA0C;AAC1C;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;;AAGL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;;;AAGA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA,KAAK,EAAE;;AAEP;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA,KAAK,YAAY;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,yCAAyC,aAAa;AACtD;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,wCAAwC,SAAS;AACjD;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,qBAAqB;;AAErB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,OAAO;AACP,KAAK,EAAE;;AAEP;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe;;AAEf;AACA,iBAAiB;;AAEjB,cAAc;;AAEd;AACA;AACA;AACA;AACA,mBAAmB;;AAEnB;AACA;AACA,eAAe;;AAEf;AACA,qBAAqB;;AAErB;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;;AAE9C;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,gCAAgC;;AAEhC;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;;AAEA;AACA,WAAW;;;AAGX;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;;AAGP;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;;AAEA,cAAc;;;;;;;;;;;;;;;;ACj9Dd;AACA,i+DAAi+D;AACj+D;AACA,iEAAe,IAAI,E;;;;;;;;;;;;;;;ACHnB;AACA;AACA;AACA,iEAAe,IAAI,E;;;;;;;;;;;;ACHnB;;;;;;;;;;;;ACAA,qD;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA,wCAAwC,yCAAyC;WACjF;WACA;WACA,E;;;;;WCPA,wF;;;;;WCAA;WACA;WACA;WACA,sDAAsD,kBAAkB;WACxE;WACA,+CAA+C,cAAc;WAC7D,E;;;;;UCNA;UACA;UACA;UACA","file":"dat.gui.ease.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"dat.gui\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"dat.gui\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"datGuiEase\"] = factory(require(\"dat.gui\"));\n\telse\n\t\troot[\"datGuiEase\"] = factory(root[\"dat\"]);\n})(self, function(__WEBPACK_EXTERNAL_MODULE_dat_gui__) {\nreturn ","import Middleware from \"./middleware/Middleware\";\n\nexport default class EaseManager {\n    constructor() {\n        this._middlewares = [];\n    }\n\n    /**\n     * Checks whether a compatible middleware for ease was provided\n     * @param {Ease} ease - Ease instance of animation library of your choice\n     * @return {boolean}\n     */\n    hasCompatibleMiddleware(ease) {\n        return this._middlewares.some(middleware => middleware.isFormatSupported(ease));\n    }\n\n    /**\n     * Returns a compatible middleware for ease\n     * @param {Ease} ease - Ease instance of animation library of your choice\n     * @return {Middleware | null}\n     */\n    getCompatibleMiddleware(ease) {\n        return this._middlewares.find(middleware => middleware.isFormatSupported(ease)) || null;\n    }\n\n     /**\n     * Register middleware to handle Ease objects of animation library of your choice\n     * @param {Middleware} middleware - Middleware instance\n     * @return {this} self reference for chaining.\n     */\n    use(middleware) {\n        if (middleware && Middleware.checkSignature(middleware)) {\n            this._middlewares.push(middleware);\n        }\n        else {\n            console.warn(\"Middleware instance expected\");\n        }\n    }\n}","import * as dat from \"dat.gui\";\nimport GUIController from \"./controller/GUIController\";\nconst dom = dat.dom.dom;\n\nexport default function addEaseGUI(object, property, middleware) {\n    const controller = new GUIController(object, property, middleware);\n\n    // Partial copy of add() method\n    // https://github.com/dataarts/dat.gui/blob/40f4fc193e25ee51e7e57dfbbfc3118b3927169f/src/dat/gui/GUI.js#L1152\n    _recallSavedValue(this, controller);\n\n    const li = _addRow(this);\n    dom.addClass(li, \"cr\");\n    dom.addClass(li, 'ease');\n    li.appendChild(controller.domElement);\n\n    _augmentController(this, li, controller);\n\n    this.__controllers.push(controller);\n\n    return controller;\n}\n\n\nconst DEFAULT_PRESET_NAME = 'Default';\n// Copy of recallSavedValue() method\n// https://github.com/dataarts/dat.gui/blob/40f4fc193e25ee51e7e57dfbbfc3118b3927169f/src/dat/gui/GUI.js#L1080\nfunction _recallSavedValue(gui, controller) {\n    const root = gui.getRoot();\n    const matchedIndex = root.__rememberedObjects.indexOf(controller.object);\n\n    if (matchedIndex !== -1) {\n        let controllerMap = root.__rememberedObjectIndecesToControllers[matchedIndex];\n\n        if (controllerMap === undefined) {\n            controllerMap = {};\n            root.__rememberedObjectIndecesToControllers[matchedIndex] = controllerMap;\n        }\n\n        controllerMap[controller.property] = controller;\n\n        if (root.load && root.load.remembered) {\n            const presetMap = root.load.remembered;\n\n            let preset;\n\n            if (presetMap[gui.preset]) {\n                preset = presetMap[gui.preset];\n            } else if (presetMap[DEFAULT_PRESET_NAME]) {\n                preset = presetMap[DEFAULT_PRESET_NAME];\n            } else {\n                return;\n            }\n\n            if (preset[matchedIndex] && preset[matchedIndex][controller.property] !== undefined) {\n                const value = preset[matchedIndex][controller.property];\n\n                controller.initialValue = value;\n                controller.setValue(value);\n            }\n        }\n    }\n}\n\n// Partial copy of addRow() method\n// https://github.com/dataarts/dat.gui/blob/40f4fc193e25ee51e7e57dfbbfc3118b3927169f/src/dat/gui/GUI.js#L889\nfunction _addRow(gui) {\n    const li = document.createElement('li');\n    gui.__ul.appendChild(li);\n    gui.onResize();\n    return li;\n}\n\n// Partial copy of augmentController() method\n// https://github.com/dataarts/dat.gui/blob/40f4fc193e25ee51e7e57dfbbfc3118b3927169f/src/dat/gui/GUI.js#L922\nfunction _augmentController(gui, li, controller) {\n    controller.__li = li;\n    controller.__gui = this;\n\n    controller.name = function (name) {\n        this.__li.querySelector(\".property-name\").innerHTML = name;\n        return this;\n    };\n\n    controller.listen = function () {\n        this.__gui.listen(this);\n        return this;\n    };\n\n    controller.remove = function () {\n        this.__gui.remove(this);\n        return this;\n    };\n\n    if (gui.getRoot().__preset_select) {\n        controller.onValueModified = _markPresetModified.bind(null, gui, true);\n    }\n}\n\n// Copy of markPresetModified() method\n// https://github.com/dataarts/dat.gui/blob/40f4fc193e25ee51e7e57dfbbfc3118b3927169f/src/dat/gui/GUI.js#L912\nfunction _markPresetModified(gui, modified) {\n    const opt = gui.__preset_select[gui.__preset_select.selectedIndex];\n  \n    if (modified) {\n      opt.innerHTML = opt.value + '*';\n    } else {\n      opt.innerHTML = opt.value;\n    }\n}","import * as dat from \"dat.gui\";\nimport Ease from '../model/ease/Ease';\nimport EasePreset from \"../model/preset/EasePreset\";\nimport GUIView, { GUIViewEvent } from \"../view/GUIView\";\nimport GUIModel from \"../model/GUIModel\";\n\nexport default class GUIController extends dat.controllers.Controller {\n    constructor(object, property, middleware) {\n        super(...arguments);\n        \n        const rawEase = object[property];\n        const preset = middleware.import(rawEase);\n\n        this._middleware = middleware;\n        this._model = new GUIModel(middleware);\n        this._view = new GUIView(this._model.curves);\n\n        this._model.activePreset = preset;\n\n        this._view.setOrientations(this._model.getCurveOrientations(preset.curve));\n        this._view.setPreset(preset);\n        \n        if (this._middleware.isEditingSupported()) {\n            this._view.showEditButton();\n        }\n\n        this._view.on(GUIViewEvent.CURVE_PRESET_SELECTED, this._onCurvePresetSelected.bind(this));\n        this._view.on(GUIViewEvent.ORIENTATION_PRESET_SELECTED, this._onOrientationPresetSelected.bind(this));\n        this._view.on(GUIViewEvent.CONFIG_PROPERTY_MODIFIED, this._onConfigPropertyModified.bind(this));\n        this._view.on(GUIViewEvent.EDIT_EASE_CLICKED, this._onEditEaseClicked.bind(this));\n        this._view.on(GUIViewEvent.EASE_MODIFIED, this._onEaseModified.bind(this));\n        this._view.on(GUIViewEvent.ACCEPT_EASE_EDIT_CLICKED, this._onAcceptEaseEditClicked.bind(this));\n        this._view.on(GUIViewEvent.DISCARD_EASE_EDIT_CLICKED, this._onDiscardEaseEditClicked.bind(this));\n\n        this.domElement = this._view.domElement;\n        this._onValueModified = null;\n    }\n\n    // Called from dat.GUI to store serialized value in revertable preset\n    // (part of dat.GUi.prototype.remember() functionality)\n    getValue() {\n        return this._model.activePreset.ease.toString();\n    }\n\n    // Called from dat.GUI upon initializing with remembered value\n    // or once preset is reverted\n    setValue(easeSvgPath) {\n        const ease = Ease.fromSVGPath(easeSvgPath);\n        const matchingPreset = this._model.getPresetMatchingEase(ease);\n        \n        if (matchingPreset) {\n            this._model.activePreset = matchingPreset;\n        }\n        else {\n            this._model.activePreset = new EasePreset(ease, EasePreset.CURVE.CUSTOM, EasePreset.ORIENTATION.NONE);\n        }\n        \n        this._view.setOrientations(this._model.getCurveOrientations(this._model.activePreset.curve));\n        this._view.setPreset(this._model.activePreset);\n\n        this._applyRevertedValue(this._model.activePreset);\n    }\n\n    set onValueModified(callback) {\n        this._onValueModified = callback;\n    }\n\n    _applyValue(preset) {\n        this._applyRevertedValue(preset);\n\n        if (this._onValueModified) {\n            this._onValueModified();\n        }\n    }\n\n    _applyRevertedValue(preset) {\n        const externalEase = this._middleware.export(preset);\n        this.object[this.property] = externalEase;\n        \n        if (this.__onChange) {\n            this.__onChange.call(this, externalEase);\n        }\n        if (this.__onFinishChange) {\n            this.__onFinishChange.call(this, externalEase);\n        }\n\n        this.updateDisplay();\n    }\n\n    _onCurvePresetSelected(nextCurve) {\n        const { orientation: currentOrientation } = this._model.activePreset;\n        const nextOrientations = this._model.getCurveOrientations(nextCurve);\n        const nextOrientation = nextOrientations.includes(currentOrientation) ? currentOrientation : nextOrientations[0];\n        const nextPreset = this._model.getMatchingPreset(nextCurve, nextOrientation);\n\n        this._model.activePreset = nextPreset;\n\n        this._view.setOrientations(nextOrientations);\n        this._view.setPreset(nextPreset);\n\n        this._applyValue(nextPreset);\n    }\n\n    _onOrientationPresetSelected(nextOrientation) {\n        const nextPreset = this._model.getMatchingPreset(this._model.activePreset.curve, nextOrientation);\n\n        this._model.activePreset = nextPreset;\n        this._view.setPreset(nextPreset);\n\n        this._applyValue(nextPreset);\n    }\n\n    _onConfigPropertyModified(propertyName, propertyValue) {\n        console.log(propertyName, propertyValue);\n        // this._model.activePreset.config[propertyName] = propertyValue;\n\n        // if (this._model.activePreset.watchers.has(propertyName)) {\n        //     const watcher = this._model.activePreset.watchers.get(propertyName);\n\n        // }\n    }\n\n    _onEditEaseClicked() {\n        this._model.preEditPreset = this._model.activePreset.clone();\n\n        this._view.openEditor(this._model.activePreset.ease);\n    }\n\n    _onEaseModified(modifiedEase) {\n        const matchingPreset = this._model.getPresetMatchingEase(modifiedEase);\n\n        if (matchingPreset) {\n            this._model.activePreset = matchingPreset;\n        }\n        else {\n            this._model.activePreset = new EasePreset(modifiedEase, EasePreset.CURVE.CUSTOM, EasePreset.ORIENTATION.NONE);\n        }\n\n        this._view.setPreset(this._model.activePreset);\n        this._applyValue(this._model.activePreset);\n    }\n\n    _onAcceptEaseEditClicked() {\n        this._view.closeEditor();\n        this._view.setPreset(this._model.activePreset);\n        this._applyValue(this._model.activePreset);\n    }\n\n    _onDiscardEaseEditClicked() {\n        this._model.activePreset = this._model.preEditPreset;\n        this._view.closeEditor();\n        this._view.setPreset(this._model.activePreset);\n        this._applyValue(this._model.activePreset);\n    }\n};","class GUIModel {\n    constructor(middleware) {\n        this._presets = middleware.presets;\n        this._curves = _extractCurves(this._presets);\n        this._orientationsMap = _extractOrientationsPerCurveMap(this._presets, this._curves);\n        this._activePreset = null;\n        this._preEditPreset = null;\n    }\n\n    get presets() {\n        return this._presets;\n    }\n\n    get curves() {\n        return this._curves;\n    }\n\n    get activePreset() {\n        return this._activePreset;\n    }\n\n    set activePreset(preset) {\n        this._activePreset = preset;\n    }\n\n    get preEditPreset() {\n        return this._preEditPreset;\n    }\n\n    set preEditPreset(preset) {\n        this._preEditPreset = preset;\n    }\n\n    getCurveOrientations(curve) {\n        return this._orientationsMap.get(curve) || [];\n    }\n\n    getMatchingPreset(curve, orientation) {\n        return this._presets.find(preset => preset.curve === curve && preset.orientation === orientation);\n    }\n\n    getPresetMatchingEase(ease) {\n        return this._presets.find(preset => preset.ease.equals(ease));\n    }\n}\n\nfunction _extractCurves(presets) {\n    return presets.reduce((curves, preset) => curves.includes(preset.curve) ? curves : [...curves, preset.curve], []);\n}\n\nfunction _extractOrientationsPerCurveMap(presets, curves) {\n    const orientationsMap = new Map();\n\n    for (let curve of curves) {\n        const curveMatchingPresets = presets.filter(preset => preset.curve === curve);\n        const orientations = curveMatchingPresets.map(preset => preset.orientation);\n\n        orientationsMap.set(curve, orientations);\n    }\n\n    return orientationsMap;\n}\n\nexport default GUIModel;","import Anchor from \"./composites/Anchor\";\nimport Handle from \"./composites/Handle\";\nimport Point from \"./composites/Point\";\nimport InvalidSVGPathException from \"./exceptions/InvalidSVGPathException\";\nimport { Bezier } from \"bezier-js\"; // consider switching entire Ease class to bezier-js \n\nexport default class Ease {\n    constructor(...anchors) {\n        this._anchors = Array.from(anchors);\n    }\n\n    get anchors() {\n        return this._anchors;\n    }\n\n    get firstAnchor() {\n        return this._anchors[0];\n    }\n\n    get lastAnchor() {\n        return this._anchors[this._anchors.length - 1];\n    }\n\n    get svgPath() {\n        return Ease.toSVGPath(this);\n    }\n\n    get points() {\n        const points = [];\n\n        for (let i = 0; i < this.anchors.length; i += 2) {\n            const startAnchor = this.anchors[i];\n            const endAnchor = this.anchors[i + 1];\n            \n            points.push(startAnchor.toPoint(), startAnchor.handle.toPoint(), endAnchor.handle.toPoint(), endAnchor.toPoint());\n        }\n\n        return points;\n    }\n\n    computeValue(t) {\n        const [segmentStartAnchor, segmentEndAnchor] = findBezierSegment(this._anchors, t);\n        const segmentT = (t - segmentStartAnchor.x) / (segmentEndAnchor.x - segmentStartAnchor.x);\n        \n        if (segmentT.toFixed(3) === \"0.000\" || segmentT.toFixed(3) === \"1.000\") {\n            const segmentAnchor = segmentT === 0 ? segmentStartAnchor : segmentEndAnchor;\n\n            return segmentAnchor.y;\n        }\n        else {\n            const segmentBezier = new Bezier(segmentStartAnchor, segmentStartAnchor.handle, segmentEndAnchor.handle, segmentEndAnchor);\n            const segmentBezierStep = segmentBezier.intersects({p1: {x: t, y: -10}, p2: {x: t, y: 10}}).shift();\n            \n            return segmentBezier.get(segmentBezierStep).y;\n        }\n    }\n\n    equals(ease) {\n        return this.svgPath === ease.svgPath;\n    }\n    \n    addAnchor(x, y) {\n        const anchor = new Anchor(x, y);\n        this.anchors.push(anchor);\n        return anchor;\n    }\n\n    toString() {\n        return this.svgPath;\n    }\n\n    clone() {\n        return Ease.of(...this._anchors.map(anchor => anchor.clone()));\n    }\n\n    static of(...anchors) {\n        return new Ease(...anchors);\n    }\n\n    static ofSVGPath(svgPath) {\n        try {\n            const trimmedPath = svgPath.trim();\n            const [startX, startY] = trimmedPath.match(/^M *(?<x>[\\d\\.]+),(?<y>[\\d\\.]+)/).splice(-2).map(safeParseCoordinate);\n            const cCoords = trimmedPath.replace(/^M.*C */, \"\").replace(/ *$/, \"\").split(/[ ,]/).map(safeParseCoordinate);\n\n            if (cCoords.length % 6 !== 0) {\n                throw new Error(\"Irregular number of coordinates provided.\")\n            }\n            else {\n                const anchors = [];\n\n                anchors[0] = Anchor.ofOriginAndHandle(\n                    Point.of(startX, startY),\n                    Point.of(cCoords[0], cCoords[1])\n                );\n        \n                for (let i = 2; i < cCoords.length - 4; i += 6) {\n                    const a = (i - 2) / 3 + 1;\n                    \n                    anchors[a] = Anchor.ofOriginAndHandle(\n                        Point.of(cCoords[i + 2], cCoords[i + 3]),\n                        Point.of(cCoords[i],  cCoords[i + 1])\n                    );\n    \n                    anchors[a + 1] = Anchor.ofOriginAndHandle(\n                        Point.of(cCoords[i + 2], cCoords[i + 3]),\n                        Point.of(cCoords[i + 4], cCoords[i + 5])\n                    );\n                }\n    \n                const lastAnchor = Anchor.ofOriginAndHandle(\n                    Point.of(...cCoords.slice(-2)),\n                    Point.of(cCoords[cCoords.length - 4], cCoords[cCoords.length - 3])\n                );\n    \n                anchors.push(lastAnchor);\n                \n                return Ease.of(...anchors);\n            }\n        }\n        catch (e) {\n            throw new InvalidSVGPathException(e);\n        }\n    }\n\n    static toSVGPath(ease) {\n        let path = `M ${ease.firstAnchor.x},${ease.firstAnchor.y} C`;\n\n        for (let i = 0; i < ease.anchors.length; i += 2) {\n            const startAnchor = ease.anchors[i];\n            const endAnchor = ease.anchors[i + 1];\n            \n            path += ` ${startAnchor.handle.x},${startAnchor.handle.y} ${endAnchor.handle.x},${endAnchor.handle.y} ${endAnchor.x},${endAnchor.y}`;\n        }\n\n        const points = ease.points;\n        const originPoint = points.shift();\n        let path2 = `M ${originPoint.x},${originPoint.y} C`;\n\n        for (let point of points) {\n            path2 += ` ${point.x},${point.y}`;\n        }\n\n        return path;\n    }\n}\n\nfunction findBezierSegment(anchors, progress) {\n    let startAnchor, endAnchor;\n\n    for (let i = 0; i < anchors.length; i++) {\n        startAnchor = anchors[i];\n        endAnchor = anchors[i + 1];\n\n        if (startAnchor.x <= progress && endAnchor.x >= progress) break;\n    }\n\n    return [startAnchor, endAnchor];\n}\n\nfunction safeParseCoordinate(rawCoordinate) {\n    const coordinate = Number.parseFloat(rawCoordinate);\n    if (coordinate === NaN) throw new Error(`Error parsing coordinate \"${rawCoordinate}\"`);\n    return coordinate;\n}\n\nexport {\n    Anchor,\n    Handle,\n    Point,\n    InvalidSVGPathException\n}","import Handle from \"./Handle\";\nimport Point from \"./Point\";\n\nexport default class Anchor extends Point {\n    constructor(x, y) {\n        super(x, y);\n        this.handle = new Handle(x, y);\n    }\n\n    toPoint() {\n        return Point.of(this.x, this.y);\n    }\n\n    clone() {\n        const clone = Anchor.ofOrigin(this);\n        clone.handle.copy(this.handle);\n        return clone;\n    }\n\n    static ofOriginAndHandle(originPointLike, handlePointLike) {\n        const anchor = Anchor.ofOrigin(originPointLike);\n        anchor.handle.copy(handlePointLike);\n        return anchor;\n    }\n\n    static ofOrigin(pointLike) {\n        return Anchor.of(pointLike.x, pointLike.y)\n    }\n\n    static of(x, y) {\n        return new Anchor(x, y);\n    }\n}","import Point from \"./Point\";\n\nexport default class Handle extends Point {\n    toPoint() {\n        return Point.of(this.x, this.y);\n    }\n    \n    static of(x, y) {\n        return new Handle(x, y);\n    }\n}","export default class Point {\n    constructor(x = 0, y = 0) {\n        this.x = x;\n        this.y = y;\n    }\n\n    copy(pointLike) {\n        this.x = pointLike.x;\n        this.y = pointLike.y;\n    }\n\n    static of(x, y) {\n        return new Point(x, y);\n    }\n}","export default class InvalidSVGPathException extends Error {}","import Ease from \"../ease/Ease\";\nimport EasePresetProps from \"./EasePresetProps\";\nimport Curve from \"./enum/Curve\";\nimport Orientation from \"./enum/Orientation\";\n\nclass EasePreset {\n    static CURVE = Curve;\n    static ORIENTATION = Orientation;\n\n    constructor(easeOrSvgPath, curve = EasePreset.CURVE.UNDEFINED, orientation = EasePreset.ORIENTATION.NONE) {\n        this.ease = easeOrSvgPath instanceof Ease ? easeOrSvgPath : Ease.ofSVGPath(easeOrSvgPath);\n        this.curve = curve;\n        this.orientation = orientation;\n        this.props = new EasePresetProps(this);\n    }\n\n    clone() {\n        const clone = EasePreset.of(this.ease.toString(), this.curve, this.orientation);\n        for (let [propertyName, propertyValue] of this.props.entries()) {\n            clone.props.add(propertyName, propertyValue);\n        }\n        return clone;\n    }\n\n    toString() {\n        return `[${this.ease.toString()}][${this.curve}.${this.orientation}]`;\n    }\n\n    equals(preset) {\n        return this.toString() === preset.toString();\n    }\n\n    property(propertyName, defaultValue, watcherFn) {\n        this.props.add(propertyName, defaultValue, watcherFn);\n        return this;\n    }\n\n    static of(svgPath, curve = EasePreset.CURVE.UNDEFINED, orientation = EasePreset.ORIENTATION.NONE) {\n        return new EasePreset(svgPath, curve, orientation);\n    }\n}\n\nexport {\n    Curve,\n    Orientation\n}\n\nexport default EasePreset;","export default class EasePresetProps extends Map {\n    constructor(preset) {\n        super();\n        \n        this._preset = preset;\n        this._watchers = new Map();\n    }\n\n    add(propertyName, defaultValue, watcherFn) {\n        this.set(propertyName, defaultValue);\n\n        if (typeof watchFn === \"function\") {\n            this._watchers.set(propertyName, watcherFn);\n        }\n    }\n\n    set(propertyName, value) {\n        super.set(propertyName, value);\n\n        if (this._watchers.has(propertyName)) {\n            const watcherFn = this._watchers.get(propertyName);\n\n            watcherFn(value, this._preset);\n        }\n    }\n}","class EasePresetProvider {\n    constructor(providerFunction) {\n        this._providerFunction = providerFunction;\n        this._curveAlias = null;\n        this._orientationAlias = null;\n        this._props = {};\n    }\n\n    withAlias(curveAlias) {\n        this._curveAlias = curveAlias;\n        return this;\n    }\n\n    withOrientation(orientation) {\n        this._orientationAlias = orientation;\n        return this;\n    }\n\n    property(propertyName, defaultValue) {\n        this._props[propertyName] = defaultValue;\n        return this;\n    }\n\n    next() {\n        const preset = this._providerFunction();\n        \n        if (this._curveAlias) {\n            preset.curve = this._curveAlias;\n        }\n\n        if (this._orientationAlias) {\n            preset.orientation = this._orientationAlias;\n        }\n\n        for (let propertyName in this._props) {\n            preset.property(propertyName, this._props[propertyName]);\n        }\n\n        return preset;\n    }\n\n    static ofSample(preset) {\n        return new EasePresetProvider(() => preset.clone());\n    }\n}\n\nexport default EasePresetProvider;","export default Object.freeze({\n    LINEAR: \"Linear\",\n    SINE: \"Sine\",\n    QUAD: \"Quad\",\n    CUBIC: \"Cubic\",\n    QUART: \"Quart\",\n    QUINT: \"Quint\",\n    EXPO: \"Expo\",\n    CIRC: \"Circ\",\n    BACK: \"Back\",\n    ELASTIC: \"Elastic\",\n    BOUNCE: \"Bounce\",\n    CUSTOM: \"Custom\",\n    UNDEFINED: \"Undefined\"\n});\n","export default Object.freeze({\n    IN: \"in\",\n    OUT: \"out\",\n    IN_OUT: \"inOut\",\n    NONE: \"none\"\n});","import EasePreset, { Curve, Orientation } from \"./EasePreset\";\nimport EasePresetProvider from \"./EasePresetProvider\";\n\n// Predefined list of easings commonly used across various animation engines\n// https://easings.net/\n\nexport const Linear = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0,0 1,1 1,1\", Curve.LINEAR, Orientation.NONE));\n\nexport const SineIn = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.12,0 0.39,0 1,1\", Curve.SINE, Orientation.IN));\nexport const SineOut = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.61,1 0.88,1 1,1\", Curve.SINE, Orientation.OUT));\nexport const SineInOut = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.37,0 0.63,1 1,1\", Curve.SINE, Orientation.IN_OUT));\n\nexport const QuadIn = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.11,0 0.5,0 1,1\", Curve.QUAD, Orientation.IN));\nexport const QuadOut = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.5,1 0.89,1 1,1\", Curve.QUAD, Orientation.OUT));\nexport const QuadInOut = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.45,0 0.55,1 1,1\", Curve.QUAD, Orientation.IN_OUT));\n\nexport const CubicIn = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.32,0 0.67,0 1,1\", Curve.CUBIC, Orientation.IN));\nexport const CubicOut = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.33,1 0.68,1 1,1\", Curve.CUBIC, Orientation.OUT));\nexport const CubicInOut = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.65,0 0.35,1 1,1\", Curve.CUBIC, Orientation.IN_OUT));\n\nexport const QuartIn = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.5,0 0.75,0 1,1\", Curve.QUART, Orientation.IN));\nexport const QuartOut = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.25,1 0.5,1 1,1\", Curve.QUART, Orientation.OUT));\nexport const QuartInOut = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.76,0 0.24,1 1,1\", Curve.QUART, Orientation.IN_OUT));\n\nexport const ExpoIn = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.7,0 0.84,0 1,1\", Curve.EXPO, Orientation.IN));\nexport const ExpoOut = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.16,1 0.3,1 1,1\", Curve.EXPO, Orientation.OUT));\nexport const ExpoInOut = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.87,0 0.13,1 1,1\", Curve.EXPO, Orientation.IN_OUT));\n\nexport const CircIn = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.55,0 1,0.45 1,1\", Curve.CIRC, Orientation.IN));\nexport const CircOut = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0,0.55 0.45,1 1,1\", Curve.CIRC, Orientation.OUT));\nexport const CircInOut = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.85,0 0.15,1 1,1\", Curve.CIRC, Orientation.IN_OUT));\n\nexport const BackIn = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.36,0 0.66,-0.56 1,1\", Curve.BACK, Orientation.IN));\nexport const BackOut = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.34,1.56 0.64,1 1,1\", Curve.BACK, Orientation.OUT));\nexport const BackInOut = EasePresetProvider.ofSample(EasePreset.of(\"M 0,0 C 0.68,-0.6 0.32,1.6 1,1\", Curve.BACK, Orientation.IN_OUT));","import domTemplate from \"./dom/gui.html\";\nimport GUIViewEvent from \"./GUIViewEvent\";\nimport EasePanelDirector from \"./dom/directors/EasePanelDirector\";\nimport HTMLElementDirector from \"./HTMLElementDirector\";\nimport EaseEditorDirector from \"./dom/directors/EaseEditorDirector\";\nimport EasePropertiesDirector from \"./dom/directors/EasePropertiesDirector\";\n\nclass GUIView extends HTMLElementDirector {\n    constructor(curves) {\n        super(_renderTemplate(domTemplate));\n\n        this._easePanelDirector = new EasePanelDirector(this._element, curves);\n        this._easePropertiesDirector = new EasePropertiesDirector(this._element);\n        this._easeEditorDirector = null;\n\n        this._easePanelDirector.on(GUIViewEvent.CURVE_PRESET_SELECTED, (...args) => this.emit(GUIViewEvent.CURVE_PRESET_SELECTED, ...args));\n        this._easePanelDirector.on(GUIViewEvent.ORIENTATION_PRESET_SELECTED, (...args) => this.emit(GUIViewEvent.ORIENTATION_PRESET_SELECTED, ...args));\n        this._easePanelDirector.on(GUIViewEvent.EDIT_EASE_CLICKED, (...args) => this.emit(GUIViewEvent.EDIT_EASE_CLICKED, ...args));\n    }\n\n    setOrientations(orientations) {\n        this._easePanelDirector.setOrientations(orientations);\n    }\n\n    setPreset(preset) {\n        this._easePanelDirector.setPreset(preset);\n        this._easePropertiesDirector.values = preset.props;\n        \n        if (this._isEditorOpen()) {\n            this._easeEditorDirector.ease = preset.ease;\n        }\n    }\n\n    openEditor(initialEase) {\n        if (this._isEditorOpen()) return;\n\n        this._element.classList.remove(\"mode-select\");\n        this._element.classList.add(\"mode-edit\");\n\n        this._easeEditorDirector = new EaseEditorDirector(this._element);\n        this._easeEditorDirector.on(GUIViewEvent.ACCEPT_EASE_EDIT_CLICKED, (...args) => this.emit(GUIViewEvent.ACCEPT_EASE_EDIT_CLICKED, ...args));\n        this._easeEditorDirector.on(GUIViewEvent.DISCARD_EASE_EDIT_CLICKED, (...args) => this.emit(GUIViewEvent.DISCARD_EASE_EDIT_CLICKED, ...args));\n        this._easeEditorDirector.on(GUIViewEvent.EASE_MODIFIED, (...args) => this.emit(GUIViewEvent.EASE_MODIFIED, ...args));\n        this._easeEditorDirector.ease = initialEase;\n    }\n\n    closeEditor() {\n        if (!this._isEditorOpen()) return;\n\n        this._element.classList.remove(\"mode-edit\");\n        this._element.classList.add(\"mode-select\");\n\n        this._easeEditorDirector.cleanUp();\n        this._easeEditorDirector = null;\n    }\n\n    showEditButton() {\n        this._easePanelDirector.showEditButton();\n    }\n\n    get domElement() {\n        return this._element;\n    }\n\n    _isEditorOpen() {\n        return !!this._easeEditorDirector;\n    }\n}\n\nfunction _renderTemplate(template) {\n    return (new DOMParser()).parseFromString(template, \"text/html\").body.firstChild;\n}\n\nexport {\n    GUIViewEvent\n};\n\nexport default GUIView;","export default Object.freeze({\n    CURVE_PRESET_SELECTED: \"CurvePresetSelectedGUIViewEvent\",\n    ORIENTATION_PRESET_SELECTED: \"OrientationPresetSelectedGUIViewEvent\",\n    CONFIG_PROPERTY_MODIFIED: \"ConfigPropertyModifiedGUIViewEvent\",\n    EDIT_EASE_CLICKED: \"EditEaseClickedGUIViewEvent\",\n    EASE_MODIFIED: \"EaseModifiedGUIViewEvent\",\n    ACCEPT_EASE_EDIT_CLICKED: \"AcceptEaseEditClickedGUIViewEvent\",\n    DISCARD_EASE_EDIT_CLICKED: \"DiscardEaseEditClickedGUIViewEvent\"\n});","export default class HTMLElementDirector {\n    constructor(htmlElement) {\n        this._element = htmlElement;\n    }\n\n    on(eventKey, callback) {\n        this._element.addEventListener(eventKey, event => callback(...event.detail));\n    }\n\n    emit(eventKey, ...args) {\n        this._element.dispatchEvent(new CustomEvent(eventKey, { detail: args }));\n    }\n}","import HTMLElementDirector from \"../../HTMLElementDirector\";\nimport { curveSelector } from \"../selectors\";\nimport { Curve } from \"../../../model/preset/EasePreset\";\nimport GUIViewEvent from  \"../../GUIViewEvent\";\n\nexport default class CurveSelectorDirector extends HTMLElementDirector {\n    constructor(rootDomElement, curves) {\n        super(curveSelector(rootDomElement));\n\n        for (let option of this._composeOptions(curves)) {\n            this._element.options.add(option);\n        }\n\n        this._element.onchange = () => this.emit(GUIViewEvent.CURVE_PRESET_SELECTED, this._element.value);\n    }\n\n    set value(curve) {\n        this._element.value = curve;\n    }\n\n    _composeOptions(curves) {\n        const options = curves.map(curve => new Option(curve, curve));\n\n        return [...options, this._createCustomCurveOption()];\n    }\n    \n    _createCustomCurveOption() {\n        const customCurveOption = new Option(Curve.CUSTOM, Curve.CUSTOM);\n        customCurveOption.setAttribute(\"hidden\", true);\n        return customCurveOption;\n    }\n}","import Ease from \"../../../model/ease/Ease\";\nimport EaseEditor, { EditorCurveChangeEvent } from \"../../editor/EaseEditor\";\nimport { GUIViewEvent } from \"../../GUIView\";\nimport HTMLElementDirector from \"../../HTMLElementDirector\";\nimport { editorAcceptButton, editorCanvas, editorDeclineButton, editorSvgPathCopyButton, editorSvgPathInspector } from \"../selectors\";\n\nexport default class EaseEditorDirector extends HTMLElementDirector {\n    constructor(rootDomElement) {\n        super(editorCanvas(rootDomElement));\n        \n        this._editor = new EaseEditor(this._element);\n        this._element.addEventListener(EditorCurveChangeEvent.KEY, () => this.emit(GUIViewEvent.EASE_MODIFIED, this._editor.ease));\n\n        this._svgPathInspector = this._initSvgPathInspector(rootDomElement);\n        this._copyButton = this._initCopyButton(rootDomElement, this._svgPathInspector);\n        this._acceptButton = this._initAcceptButton(rootDomElement);\n        this._discardButton = this._initDiscardButton(rootDomElement);\n    }\n\n    set ease(ease) {\n        this._editor.ease = ease;\n        this._svgPathInspector.value = ease.toString();\n    }\n    \n    cleanUp() {\n        // Hack to reset event listeners assigned to original canvas by CurveJS & external listeners\n        const canvas = this._element\n        const canvasClone = canvas.cloneNode(true);\n\n        canvas.parentNode.replaceChild(canvasClone, canvas);\n    }\n\n    _initSvgPathInspector(rootDomElement) {\n        const inspectorElement = editorSvgPathInspector(rootDomElement);\n\n        inspectorElement.oninput = event => {\n            try {\n                const ease = Ease.fromSVGPath(inspectorElement.value);\n\n                this._editor.ease = ease;\n                this.emit(GUIViewEvent.EASE_MODIFIED, ease);\n            }\n            catch(e) {\n                console.warn(`Couldn't parse SVG path ${inspectorElement.value}`);\n            }\n        }\n\n        return inspectorElement;\n    }\n\n    _initCopyButton(rootDomElement, svgPathInspectorElement) {\n        const buttonElement = editorSvgPathCopyButton(rootDomElement);\n\n        buttonElement.onclick = () => {\n            svgPathInspectorElement.select();\n            document.execCommand(\"copy\");\n            console.info(`Copied ${svgPathInspectorElement.value}`);\n        };\n\n        return buttonElement;\n    }\n\n    _initAcceptButton(rootDomElement) {\n        const buttonElement = editorAcceptButton(rootDomElement);\n\n        buttonElement.onclick = () => this.emit(GUIViewEvent.ACCEPT_EASE_EDIT_CLICKED, this._editor.ease);\n\n        return buttonElement;\n    }\n\n    _initDiscardButton(rootDomElement) {\n        const buttonElement = editorDeclineButton(rootDomElement);\n\n        buttonElement.onclick = () => this.emit(GUIViewEvent.DISCARD_EASE_EDIT_CLICKED);\n\n        return buttonElement;\n    }\n}","import HTMLElementDirector from \"../../HTMLElementDirector\";\nimport { cornerCurveCanvas } from \"../selectors\";\n\nexport default class EasePanelBackgroundDirector extends HTMLElementDirector {\n    constructor(rootDomElement) {\n        super();\n\n        this._cornerCurveCanvas = cornerCurveCanvas(rootDomElement);\n        this._cornerCurveCanvas.width = this._cornerCurveCanvas.height = 60;\n\n        this._cornerCurveCanvasContext = this._cornerCurveCanvas.getContext(\"2d\");\n    }\n\n    refresh(ease) {\n        const ctx = this._cornerCurveCanvasContext;\n        const { width, height } = this._cornerCurveCanvas;\n\n        ctx.strokeStyle = ctx.fillStyle = \"#88CE02\";\n\t\tctx.lineWidth = 1;\n        ctx.clearRect(0, 0, width, height);\n        ctx.beginPath();\n\t\tctx.moveTo(ease.firstAnchor.x * width, (1 - ease.firstAnchor.y) * height);\n        \n        for (let i = 0; i < ease.anchors.length; i += 2) {\n            const startAnchor = ease.anchors[i];\n            const endAnchor = ease.anchors[i + 1];\n\n            ctx.bezierCurveTo(\n                startAnchor.handle.x * width, (1 - startAnchor.handle.y) * height, \n                endAnchor.handle.x * width, (1 - endAnchor.handle.y) * height, \n                endAnchor.x * width, (1 - endAnchor.y) * height);\n        }\n\n        ctx.lineTo(width, height);\n        ctx.lineTo(0, height);\n        ctx.stroke();\n        ctx.fill();\n    }\n}","import HTMLElementDirector from \"../../HTMLElementDirector\";\nimport { easePanel, editButton } from \"../selectors\";\nimport CurveSelectorDirector from \"./CurveSelectorDirector\";\nimport OrientationSelectorDirector from \"./OrientationSelectorDirector\";\nimport GUIViewEvent from \"../../GUIViewEvent\";\nimport EasePanelBackgroundDirector from \"./EasePanelBackgroundDirector\";\n\nexport default class EasePanelDirector extends HTMLElementDirector {\n    constructor(rootDomElement, curves) {\n        super(easePanel(rootDomElement));\n\n        this._curveSelector = new CurveSelectorDirector(rootDomElement, curves);\n        this._curveSelector.on(GUIViewEvent.CURVE_PRESET_SELECTED, (...args) => this.emit(GUIViewEvent.CURVE_PRESET_SELECTED, ...args));\n\n        this._orientationSelector = new OrientationSelectorDirector(rootDomElement);\n        this._orientationSelector.on(GUIViewEvent.ORIENTATION_PRESET_SELECTED, (...args) => this.emit(GUIViewEvent.ORIENTATION_PRESET_SELECTED, ...args));\n\n        this._background = new EasePanelBackgroundDirector(rootDomElement);\n\n        this._editButtonElement = editButton(rootDomElement);\n        this._editButtonElement.style.display = \"none\"\n        this._editButtonElement.addEventListener(\"click\", () => this.emit(GUIViewEvent.EDIT_EASE_CLICKED));\n    }\n\n    setOrientations(orientations) {\n        this._orientationSelector.values = orientations;\n    }\n\n    setPreset(preset) {\n        this._curveSelector.value = preset.curve;\n        this._orientationSelector.value = preset.orientation;\n        this._background.refresh(preset.ease);\n    }\n\n    showEditButton() {\n        this._editButtonElement.style.display = null;\n    }\n}","import propertyDomTemplate from \"../property.html\";\nimport HTMLElementDirector from \"../../HTMLElementDirector\";\nimport { propertiesContainer } from \"../selectors\";\nimport { controllers } from \"dat.gui\";\nconst { StringController, NumberControllerBox: NumberController, BooleanController } = controllers;\n\nclass EasePropertiesDirector extends HTMLElementDirector {\n    constructor(rootDomElement) {\n        super(propertiesContainer(rootDomElement));\n    }\n\n    set values(props) {\n        this._element.innerHTML = \"\";\n        \n        for (let [propertyName, propertyValue] of props.entries()) {\n            const controller = createDatGuiController(propertyName, propertyValue);\n            const propertyElement = _renderTemplate(propertyDomTemplate);\n            const className = typeof propertyValue;\n            \n            controller.domElement.classList.add(\"c\", className);\n            propertyElement.classList.add(className);\n            propertyElement.querySelector(\"span.property-name\").innerHTML = propertyName;\n            propertyElement.firstElementChild.append(controller.domElement);\n\n            controller.onChange((arg1, arg2) => console.log(arg1, arg2));\n\n            this._element.append(propertyElement);\n        }\n    }\n}\n\nfunction createDatGuiController(propertyName, propertyValue) {\n    const config = { [propertyName]: propertyValue };\n\n    switch(typeof propertyValue) {\n        case \"string\":\n            return new StringController(config, propertyName);\n        case \"number\":\n            return new NumberController(config, propertyName);\n        case \"boolean\":\n            return new BooleanController(config, propertyName);\n    }\n}\n\nfunction _renderTemplate(template) {\n    return (new DOMParser()).parseFromString(template, \"text/html\").body.firstChild;\n}\n\nexport default EasePropertiesDirector;","import HTMLElementDirector from \"../../HTMLElementDirector\";\nimport { orientationSelector } from \"../selectors\";\nimport GUIViewEvent from  \"../../GUIViewEvent\";\n\nexport default class OrientationSelectorDirector extends HTMLElementDirector {\n    constructor(rootDomElement) {\n        super(orientationSelector(rootDomElement));\n\n        this._element.onchange = () => this.emit(GUIViewEvent.ORIENTATION_PRESET_SELECTED, this._element.value);\n    }\n    \n    set values(orientations) {\n        this._element.options.length = 0;\n        \n        if (orientations.length > 0) {\n            for (let orientation of orientations) {\n                this._element.options.add(new Option(orientation, orientation));\n            }\n            this._element.removeAttribute(\"disabled\");\n        }\n        else {\n            this._element.setAttribute(\"disabled\", true);\n        }\n    }\n\n    set value(orientation) {\n        this._element.value = orientation;\n    }\n}","export function easePanel(rootDomElement) {\n    return rootDomElement.querySelector(\".ease-selector\");\n}\n\nexport function curveSelector(rootDomElement) {\n    return rootDomElement.querySelector(\".curve-selector\");\n}\n\nexport function orientationSelector(rootDomElement) {\n    return rootDomElement.querySelector(\".orientation-selector\");\n}\n\nexport function cornerCurveCanvas(rootDomElement) {\n    return rootDomElement.querySelector(\"canvas.corner-curve\");\n}\n\nexport function editButton(rootDomElement) {\n    return rootDomElement.querySelector(\".edit-button\");\n}\n\nexport function propertiesContainer(rootDomElement) {\n    return rootDomElement.querySelector(\".properties-container\");\n}\n\nexport function editorCanvas(rootDomElement) {\n    return rootDomElement.querySelector(\"canvas.editor\");\n}\n\nexport function editorSvgPathInspector(rootDomElement) {\n    return rootDomElement.querySelector(\".path-selector\");\n}\n\nexport function editorSvgPathCopyButton(rootDomElement) {\n    return rootDomElement.querySelector(\".copy-button\");\n}\n\nexport function editorAcceptButton(rootDomElement) {\n    return rootDomElement.querySelector(\".accept-button\");\n}\n\nexport function editorDeclineButton(rootDomElement) {\n    return rootDomElement.querySelector(\".decline-button\");\n}","import CurveJS from \"./lib/curvesjs/Curve\";\nimport BezierPoint from \"./lib/curvesjs/BezierPoint\";\nimport { EditorCurveChangeEvent } from \"./events\";\nimport Ease from \"../../model/ease/Ease\";\n\nexport default class EaseEditor {\n  constructor(canvas) {\n    this._canvas = canvas;\n    this._ctx = this._prepareContext(canvas);\n    this._curve = this._createCurveJSInstance(this._ctx);\n    this._propagateEvents(this._curve, canvas);\n  }\n\n  set ease(ease) {\n    const { points, pointColor, pointSize, cpDist } = this._curve;\n    const { anchors, firstAnchor, lastAnchor } = ease;\n    points.length = 0;\n\n    const firstPoint = new BezierPoint(this._toCanvasX(firstAnchor.x), this._toCanvasY(firstAnchor.y), this._ctx, pointColor, pointSize, cpDist);\n    firstPoint.cp2.x = this._toCanvasX(firstAnchor.handle.x);\n    firstPoint.cp2.y = this._toCanvasY(firstAnchor.handle.y);\n    firstPoint.cp1.x = -firstPoint.cp2.x;\n    firstPoint.cp1.y = -firstPoint.cp2.y;\n    points.push(firstPoint);\n\n    for (let i = 1; i < anchors.length - 1; i += 2) {\n      const precedingCurveEndAnchor = anchors[i];\n      const followingCurveStartAnchor = anchors[i + 1];\n      const point = new BezierPoint(this._toCanvasX(precedingCurveEndAnchor.x), this._toCanvasY(precedingCurveEndAnchor.y), this._ctx, pointColor, pointSize, cpDist);\n\n      point.cp1.x = this._toCanvasX(precedingCurveEndAnchor.handle.x);\n      point.cp1.y = this._toCanvasY(precedingCurveEndAnchor.handle.y);\n      point.cp2.x = this._toCanvasX(followingCurveStartAnchor.handle.x);\n      point.cp2.y = this._toCanvasY(followingCurveStartAnchor.handle.y);\n\n      points.push(point);\n    }\n\n    const lastPoint = new BezierPoint(this._toCanvasX(lastAnchor.x), this._toCanvasY(lastAnchor.y), this._ctx, pointColor, pointSize, cpDist);\n    lastPoint.cp1.x = this._toCanvasX(lastAnchor.handle.x);\n    lastPoint.cp1.y = this._toCanvasY(lastAnchor.handle.y);\n    lastPoint.cp2.x = -lastPoint.cp1.x;\n    lastPoint.cp2.y = -lastPoint.cp1.y;\n    points.push(lastPoint);\n\n    this._curve.draw();\n  }\n\n  get ease() {\n    const ease = new Ease();\n    const { cw, ch, points } = this._curve;\n\n    for (let i = 0; i < points.length - 1; i++) {\n      const startPoint = points[i];\n      const startAnchor = ease.addAnchor(this._fromCanvasX(startPoint.position.x), this._fromCanvasY(startPoint.position.y));\n      startAnchor.handle.x = this._fromCanvasX(startPoint.cp2.x);\n      startAnchor.handle.y = this._fromCanvasY(startPoint.cp2.y);\n\n      const endPoint = points[i + 1];\n      const endAnchor = ease.addAnchor(this._fromCanvasX(endPoint.position.x), this._fromCanvasY(endPoint.position.y));\n      endAnchor.handle.x = this._fromCanvasX(endPoint.cp1.x);\n      endAnchor.handle.y = this._fromCanvasY(endPoint.cp1.y);\n    }\n\n    return ease;\n  }\n\n  _prepareContext(canvas) {\n    const ctx = canvas.getContext(\"2d\");\n    ctx.canvas.width = canvas.clientWidth;\n    ctx.canvas.height = canvas.clientHeight;\n    return ctx;\n  }\n\n  _createCurveJSInstance(ctx) {\n    const curve = new CurveJS(ctx);\n\n    curve.setPointStyle('#ffffff', 8);\n    curve.setLineStyle('#ace247', 2);\n\n    return curve;\n  }\n\n  _propagateEvents(curve, canvas) {\n    curve.on('drag', () => canvas.dispatchEvent(new EditorCurveChangeEvent()));\n    curve.on('newpoint', () => canvas.dispatchEvent(new EditorCurveChangeEvent()));\n    curve.on('removepoint', () => canvas.dispatchEvent(new EditorCurveChangeEvent()));\n  }\n\n  _toCanvasX(x) {\n    return x * this._curve.cw;\n  }\n\n  _toCanvasY(y) {\n    return (1 - y) * this._curve.ch;\n  }\n\n  _fromCanvasX(x) {\n    return this._round(x / this._curve.cw);\n  }\n\n  _fromCanvasY(y) {\n    return this._round(1 - y / this._curve.ch);\n  }\n\n  _round(coord, numberOfFloatDigits = 3) {\n    const power = Math.pow(10, numberOfFloatDigits);\n    return Math.round(coord * power) / power;\n  }\n}\n\nexport {\n  EditorCurveChangeEvent\n}","export default class EditorCurveChangeEvent extends CustomEvent {\n    constructor() {\n        super(EditorCurveChangeEvent.KEY);\n    }\n\n    static KEY = \"editorCurveChangeEvent\";\n}","import Point from \"./Point\"\n\nexport default class BezierPoint {\n\n\tconstructor(x, y, context, color, size, cpDist) {\n\n\t\tthis.cpDist = cpDist;\n\n\t\tthis.color = color;\n\t\tthis.size = size;\n\n\t\tthis.position = new Point(x, y, this.color, this.size, context);\n\t\tthis.cp1 = new Point(x-this.cpDist, y, this.color, this.size, context);\n\t\tthis.cp2 = new Point(x+this.cpDist, y, this.color, this.size, context);\n\n\t\tthis.ctx = context;\n\t\tthis.r = 2;\n\n\t\tthis.collapsed = false;\n\n\t}\n\n\tcollapse() {\n\t\n\t\tif (!this.collapsed) {\n\t\t\tthis.collapsed = true;\n\t\t\tthis.cp1.x = this.cp2.x = this.position.x;\n\t\t\tthis.cp1.y = this.cp2.y = this.position.y;\n\t\t} else {\n\t\t\tthis.collapsed = false;\n\t\t\tthis.cp1.x = this.position.x - this.cpDist;\n\t\t\tthis.cp2.x = this.position.x + this.cpDist;\n\t\t}\n\n\t}\n\n\tmove() {\n\n\t\tif (!this.collapsed) {\n\t\t\tthis.v1x = this.cp1.x - this.position.x;\n\t\t\tthis.v1y = this.cp1.y - this.position.y;\n\t\t\tthis.v2x = this.cp2.x - this.position.x;\n\t\t\tthis.v2y = this.cp2.y - this.position.y;\n\t\t} else {\n\t\t\tthis.v1x = this.v1y = this.v2x = this.v2y = 0;\n\t\t}\n\n\t}\n\n\tsetPointStyle(color, size) {\n\n\t\tthis.position.color = color;\n\t\tthis.cp1.color = color;\n\t\tthis.cp2.color = color;\n\t\tthis.position.r = size/2;\n\t\tthis.cp1.r = size/2;\n\t\tthis.cp2.r = size/2;\n\t}\n\n\tdraw() {\n\n\t\tthis.ctx.lineWidth = 0.2;\n\n\t\tthis.ctx.beginPath();\n\t\tthis.ctx.moveTo(this.position.x, this.position.y);\n\t\tthis.ctx.lineTo(this.cp1.x, this.cp1.y);\n\t\tthis.ctx.stroke();\n\n\t\tthis.ctx.beginPath();\n\t\tthis.ctx.moveTo(this.position.x, this.position.y);\n\t\tthis.ctx.lineTo(this.cp2.x, this.cp2.y);\n\t\tthis.ctx.stroke();\n\n\t\tthis.position.draw();\n\t\tthis.cp1.draw();\n\t\tthis.cp2.draw();\n\n\t}\n}","/*\nThe MIT License (MIT)\n\nCopyright (c) 2015 Sidney Douw\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport BezierPoint from \"./BezierPoint\";\n\nexport default class Curve {\n\n\tconstructor(context, interval, cpDist) {\n\n\t\tthis.BezierPoint = BezierPoint;\n\n\t\tthis.cpDist = cpDist ? cpDist : context.canvas.width * 0.2;\n\n\t\tthis.pointColor = '#f00';\n\t\tthis.pointSize = 4;\n\n\t\tthis.lineColor = '#fff';\n\t\tthis.lineWidth = 1;\n\n\t\tthis.points = [\n\t\t\tnew BezierPoint(0, context.canvas.height, context, this.pointColor, this.pointSize, this.cpDist),\n\t\t\tnew BezierPoint(context.canvas.width, 0, context, this.pointColor, this.pointSize, this.cpDist)\n\t\t];\n\n\t\tthis.ctx = context;\n\t\tthis.cw = context.canvas.width;\n\t\tthis.ch = context.canvas.height;\n\n\t\tthis.mouseX = 0;\n\t\tthis.mouseY = 0;\n\n\t\tthis.events = {};\n\n\t\tthis.interval = interval;\n\n\t\tthis.canvasEvents();\n\t\tthis.createLUT();\n\t\tthis.draw();\n\n\t}\n\n\txGetY(frame) {\n\n\t\tlet tolerance = 0.0001;\n\t\t\n\t\tlet iMin = 0;\n\t\tlet iMax = 5000;\n\t\tlet key = (iMin+iMax)/2;\n\n\t\tlet xTarget = frame/this.interval;\n\t\tlet xCurrent = this.lookupX[key];\n\n\t\tlet i = 0;\n\n\t\twhile (Math.abs(xTarget-xCurrent) > tolerance){\n\t\t\ti++;\n\t\t\t\n\t\t\tif (xCurrent > xTarget) {\n\t\t\t\tiMax = key;\n\t\t\t} else if (xCurrent < xTarget) {\n\t\t\t\tiMin = key;\n\t\t\t}\n\t\t\tkey = Math.round((iMin+iMax)/2);\n\t\t\txCurrent = this.lookupX[key];\n\n\t\t\tif (i > 20) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn this.lookupY[key];\n\n\t}\n\n\tcreateLUT() {\n\t\t\n\t\tthis.lookupX = [];\n\t\tthis.lookupY = [];\n\n\t\t//Percent Based Tesselation\n\t\tfor (let i = 1; i < this.points.length; i++) {\n\t\t\tlet p1 = this.points[i-1];\n\t\t\tlet p2 = this.points[i];\n\t\t\tlet pct = (p2.position.x/this.cw) - (p1.position.x/this.cw);\n\t\t\tfor (let t = 0; t < 1; t+=1/(5000*pct)) {\n\t\t\t\tlet x = (Math.pow((1-t),3)*p1.position.x) + (3*Math.pow((1-t),2)*t*p1.cp2.x) + (3*(1-t)*Math.pow(t,2)*p2.cp1.x) + (Math.pow(t,3)*p2.position.x);\n\t\t\t\tlet y = (Math.pow((1-t),3)*p1.position.y) + (3*Math.pow((1-t),2)*t*p1.cp2.y) + (3*(1-t)*Math.pow(t,2)*p2.cp1.y) + (Math.pow(t,3)*p2.position.y);\n\t\t\t\tthis.lookupX.push(x/this.cw);\n\t\t\t\tthis.lookupY.push(-y/this.ch+1);\n\t\t\t}\n\t\t}\n\n\t}\n\n\ton(event, func) {\n\t\tthis.events['on'+event] = func.bind(this);\n\t}\n\n\tcanvasEvents() {\n\n\t\tlet x,\n\t\t\ty,\n\t\t\tdist,\n\t\t\tdragReady,\n\t\t\tdragCP,\n\t\t\tdraging;\n\n\t\tlet _this = this;\n\t\t\n\t\tthis.ctx.canvas.addEventListener('mousemove', function(evt){\n\n\t\t\tlet bbox = this.getBoundingClientRect();\n\n\t\t\tx = evt.clientX - bbox.left;\n\t\t\ty = evt.clientY - bbox.top;\n\n\t\t\t_this.mouseX = x;\n\t\t\t_this.mouseY = y;\n\n\t\t\tfor (let i = 0; i < _this.points.length; i++) {\n\t\t\t\tlet p = _this.points[i];\n\n\t\t\t\tif (!draging) {\n\n\t\t\t\t\tdist = Math.sqrt((x-p.position.x)*(x-p.position.x) + (y-p.position.y)*(y-p.position.y));\n\t\t\t\t\tif (dist <= _this.pointSize/2+2) {\n\t\t\t\t\t\tthis.style.cursor = 'pointer';\n\t\t\t\t\t\tdragReady = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdist = Math.sqrt((x-p.cp1.x)*(x-p.cp1.x) + (y-p.cp1.y)*(y-p.cp1.y));\n\t\t\t\t\t\tif (dist <= _this.pointSize/2+2) {\n\t\t\t\t\t\t\tthis.style.cursor = 'pointer';\n\t\t\t\t\t\t\tdragReady = i;\n\t\t\t\t\t\t\tdragCP = 'cp1';\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdist = Math.sqrt((x-p.cp2.x)*(x-p.cp2.x) + (y-p.cp2.y)*(y-p.cp2.y));\n\t\t\t\t\t\t\tif (dist <= _this.pointSize/2+2) {\n\t\t\t\t\t\t\t\tthis.style.cursor = 'pointer';\n\t\t\t\t\t\t\t\tdragReady = i;\n\t\t\t\t\t\t\t\tdragCP = 'cp2';\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.style.cursor = 'initial';\n\t\t\t\t\t\t\t\tdragReady = false;\n\t\t\t\t\t\t\t\tdragCP = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif (keys[18]) {\n\t\t\t\tlet deltaW = _this.cw / 20;\n\t\t\t\tlet deltaH = _this.ch/ 10;\n\n\t\t\t\tlet posX = Math.floor((x+deltaW/2) / deltaW);\n\t\t\t\tlet posY = Math.floor((y+deltaH/2) / deltaH);\n\n\t\t\t\tx = deltaW * posX;\n\t\t\t\ty = deltaH * posY;\n\t\t\t}\n\n\t\t\tif (draging) {\n\t\t\t\tif (dragCP == 'cp1') {\n\t\t\t\t\t_this.points[dragReady].cp1.x = x;\n\t\t\t\t\t_this.points[dragReady].cp1.y = y;\n\n\t\t\t\t\t_this.points[dragReady].move();\n\n\t\t\t\t\tif (!keys[16]) {\n\t\t\t\t\t\t_this.points[dragReady].cp2.x = x - _this.points[dragReady].v1x*2;\n\t\t\t\t\t\t_this.points[dragReady].cp2.y = y - _this.points[dragReady].v1y*2;\n\t\t\t\t\t}\n\t\t\t\t} else if (dragCP == 'cp2') {\n\n\t\t\t\t\t_this.points[dragReady].cp2.x = x;\n\t\t\t\t\t_this.points[dragReady].cp2.y = y;\n\n\t\t\t\t\t_this.points[dragReady].move();\n\n\t\t\t\t\tif (!keys[16]) {\n\t\t\t\t\t\t_this.points[dragReady].cp1.x = x - _this.points[dragReady].v2x*2;\n\t\t\t\t\t\t_this.points[dragReady].cp1.y = y - _this.points[dragReady].v2y*2;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t_this.points[dragReady].move();\n\n\t\t\t\t\t_this.points[dragReady].position.x = x;\n\t\t\t\t\t_this.points[dragReady].position.y = y;\n\n\t\t\t\t\tif (dragReady === 0) {\n\t\t\t\t\t\t_this.points[dragReady].position.x = 0;\n\t\t\t\t\t}\n\t\t\t\t\tif (dragReady == _this.points.length-1) {\n\t\t\t\t\t\t_this.points[dragReady].position.x = _this.cw;\n\t\t\t\t\t}\n\n\t\t\t\t\t_this.points[dragReady].cp1.x = _this.points[dragReady].position.x + _this.points[dragReady].v1x;\n\t\t\t\t\t_this.points[dragReady].cp1.y = _this.points[dragReady].position.y + _this.points[dragReady].v1y;\n\t\t\t\t\t_this.points[dragReady].cp2.x = _this.points[dragReady].position.x + _this.points[dragReady].v2x;\n\t\t\t\t\t_this.points[dragReady].cp2.y = _this.points[dragReady].position.y + _this.points[dragReady].v2y;\n\n\t\t\t\t\tlet temp;\n\n\t\t\t\t\tif (_this.points[dragReady-1] && _this.points[dragReady+1]) {\n\t\t\t\t\t\tif (_this.points[dragReady].position.x > _this.points[dragReady+1].position.x) {\n\t\t\t\t\t\t\ttemp = _this.points[dragReady];\n\t\t\t\t\t\t\t_this.points[dragReady] = _this.points[dragReady+1];\n\t\t\t\t\t\t\t_this.points[dragReady+1] = temp;\n\t\t\t\t\t\t\tdragReady++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (_this.points[dragReady-1].position.x > _this.points[dragReady].position.x) {\n\t\t\t\t\t\t\ttemp = _this.points[dragReady];\n\t\t\t\t\t\t\t_this.points[dragReady] = _this.points[dragReady-1];\n\t\t\t\t\t\t\t_this.points[dragReady-1] = temp;\n\t\t\t\t\t\t\tdragReady--;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\t_this.events.ondrag ? _this.events.ondrag() : null;\n\t\t\t\t_this.draw();\n\t\t\t}\n\n\t\t\t_this.events.onmousemove ? _this.events.onmousemove() : null;\n\n\t\t});\n\t\tthis.ctx.canvas.addEventListener('mousedown', function(evt){\n\t\t\tevt.preventDefault();\n\n\t\t\tif (dragReady || dragReady === 0) {\n\t\t\t\tdraging = true;\n\t\t\t} else {\n\t\t\t\tif (dist > 5) {\n\t\t\t\t\tdragReady = _this.addPoint(x, y);\n\t\t\t\t\tdraging = true;\n\t\t\t\t\tthis.style.cursor = 'pointer';\n\t\t\t\t\t_this.draw();\n\t\t\t\t\t_this.events.onnewpoint ? _this.events.onnewpoint() : null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t});\n\t\tthis.ctx.canvas.addEventListener('mouseup', function(evt){\n\n\t\t\tdraging = false;\n\t\t\tif (dist > 5) {\n\t\t\t\tdragReady = dragCP = false;\n\t\t\t}\n\n\t\t\tfor (let i = 0; i < _this.points.length; i++) {\n\t\t\t\tlet p = _this.points[i];\n\t\t\t\tdist = Math.sqrt((x-p.position.x)*(x-p.position.x) + (y-p.position.y)*(y-p.position.y));\n\t\t\t\tif (dist <= _this.pointSize/2+2) {\n\t\t\t\t\tthis.style.cursor = 'pointer';\n\t\t\t\t\tdragReady = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_this.createLUT();\n\n\t\t});\n\t\tthis.ctx.canvas.addEventListener('mouseleave', function(evt){\n\n\t\t\tif (draging) {\n\t\t\t\tif (evt.offsetX < 0 || evt.offsetX > _this.cw) {\n\t\t\t\t\tif (evt.offsetX < 0) {\n\t\t\t\t\t\tif (dragCP == 'cp1') {\n\t\t\t\t\t\t\t_this.points[dragReady].cp1.x = 0;\n\n\t\t\t\t\t\t\t_this.points[dragReady].move();\n\n\t\t\t\t\t\t\tif (!keys[16]) {\n\t\t\t\t\t\t\t\t_this.points[dragReady].cp2.x = 0 - _this.points[dragReady].v1x*2;\n\t\t\t\t\t\t\t\t_this.points[dragReady].cp2.y = y - _this.points[dragReady].v1y*2;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (dragCP == 'cp2') {\n\t\t\t\t\t\t\t_this.points[dragReady].cp2.x = 0;\n\n\t\t\t\t\t\t\t_this.points[dragReady].move();\n\n\t\t\t\t\t\t\tif (!keys[16]) {\n\t\t\t\t\t\t\t\t_this.points[dragReady].cp1.x = 0 - _this.points[dragReady].v2x*2;\n\t\t\t\t\t\t\t\t_this.points[dragReady].cp1.y = y - _this.points[dragReady].v2y*2;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t_this.points[dragReady].position.x = 0;\n\t\t\t\t\t\t\t_this.points[dragReady].cp1.x = 0 + _this.points[dragReady].v1x;\n\t\t\t\t\t\t\t_this.points[dragReady].cp2.x = 0 + _this.points[dragReady].v2x;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (dragCP == 'cp1') {\n\t\t\t\t\t\t\t_this.points[dragReady].cp1.x = _this.cw;\n\n\t\t\t\t\t\t\t_this.points[dragReady].move();\n\n\t\t\t\t\t\t\tif (!keys[16]) {\n\t\t\t\t\t\t\t\t_this.points[dragReady].cp2.x = _this.cw - _this.points[dragReady].v1x*2;\n\t\t\t\t\t\t\t\t_this.points[dragReady].cp2.y = y - _this.points[dragReady].v1y*2;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (dragCP == 'cp2') {\n\t\t\t\t\t\t\t_this.points[dragReady].cp2.x = _this.cw;\n\n\t\t\t\t\t\t\t_this.points[dragReady].move();\n\n\t\t\t\t\t\t\tif (!keys[16]) {\n\t\t\t\t\t\t\t\t_this.points[dragReady].cp1.x = _this.cw - _this.points[dragReady].v2x*2;\n\t\t\t\t\t\t\t\t_this.points[dragReady].cp1.y = y - _this.points[dragReady].v2y*2;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t_this.points[dragReady].position.x = _this.cw;\n\t\t\t\t\t\t\t_this.points[dragReady].cp1.x = _this.cw + _this.points[dragReady].v1x;\n\t\t\t\t\t\t\t_this.points[dragReady].cp2.x = _this.cw + _this.points[dragReady].v2x;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (evt.offsetY < 0 || evt.offsetY > _this.ch) {\n\t\t\t\t\tif (evt.offsetY < 0) {\n\t\t\t\t\t\tif (dragCP == 'cp1') {\n\t\t\t\t\t\t\t_this.points[dragReady].cp1.y = 0;\n\n\t\t\t\t\t\t\t_this.points[dragReady].move();\n\n\t\t\t\t\t\t\tif (!keys[16]) {\n\t\t\t\t\t\t\t\t_this.points[dragReady].cp2.x = x - _this.points[dragReady].v1x*2;\n\t\t\t\t\t\t\t\t_this.points[dragReady].cp2.y = 0 - _this.points[dragReady].v1y*2;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (dragCP == 'cp2') {\n\t\t\t\t\t\t\t_this.points[dragReady].cp2.y = 0;\n\n\t\t\t\t\t\t\t_this.points[dragReady].move();\n\n\t\t\t\t\t\t\tif (!keys[16]) {\n\t\t\t\t\t\t\t\t_this.points[dragReady].cp1.x = x - _this.points[dragReady].v2x*2;\n\t\t\t\t\t\t\t\t_this.points[dragReady].cp1.y = 0 - _this.points[dragReady].v2y*2;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t_this.points[dragReady].position.y = 0;\n\t\t\t\t\t\t\t_this.points[dragReady].cp1.y = 0 + _this.points[dragReady].v1y;\n\t\t\t\t\t\t\t_this.points[dragReady].cp2.y = 0 + _this.points[dragReady].v2y;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (dragCP == 'cp1') {\n\t\t\t\t\t\t\t_this.points[dragReady].cp1.y = _this.ch;\n\n\t\t\t\t\t\t\t_this.points[dragReady].move();\n\t\t\t\t\t\t\tif (!keys[16]) {\n\t\t\t\t\t\t\t\t_this.points[dragReady].cp2.x = x - _this.points[dragReady].v1x*2;\n\t\t\t\t\t\t\t\t_this.points[dragReady].cp2.y = _this.ch - _this.points[dragReady].v1y*2;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (dragCP == 'cp2') {\n\t\t\t\t\t\t\t_this.points[dragReady].cp2.y = _this.ch;\n\n\t\t\t\t\t\t\t_this.points[dragReady].move();\n\n\t\t\t\t\t\t\tif (!keys[16]) {\n\t\t\t\t\t\t\t\t_this.points[dragReady].cp1.x = x - _this.points[dragReady].v2x*2;\n\t\t\t\t\t\t\t\t_this.points[dragReady].cp1.y = _this.ch - _this.points[dragReady].v2y*2;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t_this.points[dragReady].position.y = _this.ch;\n\t\t\t\t\t\t\t_this.points[dragReady].cp1.y = _this.ch + _this.points[dragReady].v1y;\n\t\t\t\t\t\t\t_this.points[dragReady].cp2.y = _this.ch + _this.points[dragReady].v2y;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_this.draw();\n\t\t\t_this.createLUT();\n\n\t\t\tdraging = dragReady = dragCP = false;\n\n\t\t});\n\t\tthis.ctx.canvas.addEventListener('click', function(evt){\n\t\t\tif (keys[16] && !dragCP) {\n\t\t\t\t_this.points[dragReady].collapse();\n\t\t\t\t_this.draw();\n\t\t\t\t_this.createLUT();\n\t\t\t\t_this.events.ontogglecontrol ? _this.events.ontogglecontrol() : null;\n\t\t\t}\n\t\t});\n\t\tthis.ctx.canvas.addEventListener('dblclick', function(evt){\n\t\t\t_this.points.splice(dragReady, 1);\n\t\t\tdraging = dragReady = dragCP = false;\n\t\t\tdist = 1000;\n\t\t\tthis.style.cursor = 'initial';\n\t\t\t_this.draw();\n\t\t\t_this.createLUT();\n\t\t\t_this.events.onremovepoint ? _this.events.onremovepoint() : null;\n\t\t});\n\n\t}\n\n\taddPoint(x, y) {\n\t\t\n\t\tthis.points.push(new BezierPoint(x, y, this.ctx, this.pointColor, this.pointSize, this.cpDist));\n\n\t\tthis.points.sort(function(a, b){\n\t\t\treturn a.position.x - b.position.x;\n\t\t});\n\n\t\tfor (let i = 0; i < this.points.length; i++) {\n\t\t\tlet p = this.points[i];\n\t\t\tif (x == p.position.x && y == p.position.y) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t}\n\n\tsetPointStyle(color, size) {\n\t\t\n\t\tfor (let i = 0; i < this.points.length; i++) {\n\t\t\tthis.points[i].setPointStyle(color, size);\n\t\t\tthis.pointColor = color;\n\t\t\tthis.pointSize = size;\n\t\t}\n\t\tthis.draw();\n\n\t}\n\n\tsetLineStyle(color, width) {\n\t\t\n\t\tthis.lineColor = color;\n\t\tthis.lineWidth = width;\n\t\tthis.draw();\n\n\t}\n\n\tdraw() {\n\t\t\n\t\tthis.ctx.clearRect(0, 0, this.cw, this.ch);\n\t\t\n\t\tthis.ctx.strokeStyle = '#444';\n\t\tthis.ctx.lineWidth = 1;\n\n\t\tfor (let i = 1; i < 10; i++) {\n\t\t\tthis.ctx.beginPath();\n\t\t\tthis.ctx.moveTo((this.cw/10)*i-0.5, 0);\n\t\t\tthis.ctx.lineTo((this.cw/10)*i-0.5, this.ch);\n\t\t\tthis.ctx.stroke();\n\t\t}\n\t\tfor (let i = 1; i < 5; i++) {\n\t\t\tthis.ctx.beginPath();\n\t\t\tthis.ctx.moveTo(0, (this.ch/5)*i-0.5);\n\t\t\tthis.ctx.lineTo(this.cw, (this.ch/5)*i-0.5);\n\t\t\tthis.ctx.stroke();\n\t\t}\n\n\t\tthis.ctx.lineWidth = 0.5;\n\t\tfor (let i = 1; i < 20; i++) {\n\t\t\tthis.ctx.beginPath();\n\t\t\tthis.ctx.moveTo((this.cw/20)*i-0.5, 0);\n\t\t\tthis.ctx.lineTo((this.cw/20)*i-0.5, this.ch);\n\t\t\tthis.ctx.stroke();\n\t\t}\n\t\tfor (let i = 1; i < 10; i++) {\n\t\t\tthis.ctx.beginPath();\n\t\t\tthis.ctx.moveTo(0, (this.ch/10)*i-0.5);\n\t\t\tthis.ctx.lineTo(this.cw, (this.ch/10)*i-0.5);\n\t\t\tthis.ctx.stroke();\n\t\t}\n\n\t\tthis.ctx.strokeStyle = this.lineColor;\n\t\tthis.ctx.lineWidth = this.lineWidth;\n\n\t\tthis.ctx.beginPath();\n\t\tthis.ctx.moveTo(this.points[0].position.x, this.points[0].position.y);\n\t\tfor (let i = 1; i < this.points.length; i++) {\n\t\t\tlet p = this.points[i];\n\t\t\tlet pP = this.points[i-1];\n\t\t\tthis.ctx.bezierCurveTo(pP.cp2.x, pP.cp2.y, p.cp1.x, p.cp1.y, p.position.x, p.position.y);\n\t\t}\n\t\tthis.ctx.stroke();\n\n\t\tfor (let i = 0; i < this.points.length; i++) {\n\t\t\tthis.points[i].draw();\n\t\t}\n\n\t}\n}\n\n\nconst keys = [];\nwindow.addEventListener('keydown', function(e){\n\tkeys[e.keyCode] = true;\n});\nwindow.addEventListener('keyup', function(e){\n\tdelete keys[e.keyCode];\n});","export default class Point {\n\n\tconstructor(x, y, color, size, context) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.r = size/2;\n\t\tthis.color = color;\n\t\tthis.ctx = context;\n\n\t}\n\n\tdraw() {\n\n\t\tthis.ctx.fillStyle = this.color;\n\t\tthis.ctx.beginPath();\n\t\tthis.ctx.arc(this.x, this.y, this.r, 0, Math.PI*2, false);\n\t\tthis.ctx.closePath();\n\t\tthis.ctx.fill();\n\n\t}\n}\n","import \"./index.scss\";\nimport EaseManager from \"./EaseManager\";\nimport addEaseGUI from \"./gui/addEaseGUI\";\nimport Middleware, { middleware } from \"./middleware/Middleware\";\nimport Ease, { Handle, Anchor, Point } from \"./gui/model/ease/Ease\";\nimport EasePreset from \"./gui/model/preset/EasePreset\";\nimport * as presets from \"./gui/model/preset/presets\";\n\nconst easeManager = new EaseManager();\n\nfunction addEase(object, property) {\n    const ease = object[property];\n        \n    if (easeManager.hasCompatibleMiddleware(ease)) {\n        return addEaseGUI.call(this, object, property, easeManager.getCompatibleMiddleware(ease));\n    }\n    else {\n        console.warn(\"No compatible middleware found.\");\n    }\n}\n\nexport function extend(dat) {\n    dat.gui.ease = easeManager;\n\n    const add = dat.GUI.prototype.add;\n    function addOverride(object, property) {\n        const value = object[property] || object;\n\n        if (easeManager.hasCompatibleMiddleware(value)) {\n            return addEase.call(this, ...arguments);\n        }\n        else {\n            return add.call(this, ...arguments);\n        }\n    }\n\n    dat.GUI.prototype.add = addOverride;\n    dat.gui.GUI.prototype.add = addOverride;\n\n    dat.GUI.prototype.addEase = addEase;\n    dat.gui.GUI.prototype.addEase = addEase;\n\n    return easeManager;\n}\n\nexport {\n    Middleware,\n    EasePreset,\n    Ease,\n    Handle,\n    Anchor,\n    Point,\n    middleware,\n    presets,\n    easeManager as manager\n}\n\nexport default {\n    extend\n};","import PredicateCastEntry from \"./cast/PredicateCastEntry\";\nimport InstanceCastEntry from \"./cast/InstanceCastEntry\";\nimport TransformCastEntry from \"./cast/TransformCastEntry\";\n\nclass Middleware {\n    constructor(name, castEntries = []) {\n        this._name = name;\n        this._castEntries = castEntries;\n    }\n\n    get castEntries() {\n        return this._castEntries;\n    }\n\n    get presets() {\n        return this._castEntries.filter(castEntry => !(castEntry instanceof TransformCastEntry)).map(entry => entry.preset);\n    }\n\n    preset(thirdPartyEaseOrPredicateFunction, ...followupArguments) {\n        switch (typeof thirdPartyEaseOrPredicateFunction) {\n            case \"function\":\n                this._predicatePreset(thirdPartyEaseOrPredicateFunction, ...followupArguments);\n                return this;\n            case \"string\":\n            case \"object\":\n                this._instancePreset(thirdPartyEaseOrPredicateFunction, ...followupArguments);\n                return this;\n            default:\n                console.warn(`Unsupported ease format: `, thirdPartyEaseOrPredicate);\n                return this;\n        }\n    }\n\n    transform(predicateFunction, thirdPartyToNativeCast, nativeToThirdPartyCast) {\n        this.castEntries.push(TransformCastEntry.of(predicateFunction, thirdPartyToNativeCast, nativeToThirdPartyCast));\n        return this;\n    }\n\n    pick(predicateFunction) {\n        const middleware = this;\n\n        return {\n            transform(thirdPartyToNativeCast, nativeToThirdPartyCast) {\n                middleware.castEntries.push(TransformCastEntry.of(predicateFunction, thirdPartyToNativeCast, nativeToThirdPartyCast));\n                return middleware;\n            }\n        };\n    }\n\n    isEditingSupported() {\n        return this.castEntries.some(castEntry => castEntry instanceof TransformCastEntry);\n    }\n\n    isFormatSupported(thirdPartyEase) {\n        return this.castEntries.some(castEntry => castEntry.supportsCastInward(thirdPartyEase));\n    }\n\n    import(thirdPartyEase) {\n        const castEntry = this._castEntries.find(castEntry => castEntry.supportsCastInward(thirdPartyEase));\n        \n        if (castEntry) {\n            return castEntry.castInward(thirdPartyEase);\n        }\n        else {\n            console.warn(`Unsupported inward cast requested for ease ${thirdPartyEase.toString()}`);\n        }\n    }\n\n    export(nativeEase) {\n        const castEntry = this._castEntries.find(castEntry => castEntry.supportsCastOutward(nativeEase));\n        \n        if (castEntry) {\n            return castEntry.castOutward(nativeEase);\n        }\n        else {\n            console.warn(`Unsupported outward cast requested for ease ${nativeEase.toString()}`);\n        }\n    }\n\n    toString() {\n        return `[object DatGuiEase${this._name}Middleware]`;\n    }\n\n    static checkSignature(instanceLike) {\n        return /^\\[object DatGuiEase(?:.*)Middleware\\]$/.test(instanceLike.toString());\n    }\n\n    _predicatePreset(predicateFunction, thirdPartyToNativeCast, nativeToThirdPartyCast, nativeEasePreset) {\n        this.castEntries.push(PredicateCastEntry.of(...arguments));\n    }\n\n    _instancePreset(thirdPartyEase, nativeEasePreset) {\n        this.castEntries.push(InstanceCastEntry.of(...arguments));\n    }\n}\n\nexport function middleware(name) {\n    return new Middleware(name);\n}\n\nexport default Middleware;","export default class CastEntry {\n    supportsCastInward(thirdPartyEase) {\n        try {\n            return !!this.castInward(thirdPartyEase);\n        }\n        catch (e) {\n            return false;\n        }\n    }\n\n    supportsCastOutward(nativeEasePreset) {\n        try {\n            return !!this.castOutward(nativeEasePreset);\n        }\n        catch (e) {\n            return false;\n        }\n    }\n\n    castInward(thirdPartyEase) {\n        throw new Error(\"Method override missing\");\n    }\n\n    castOutward(nativeEasePreset) {\n        throw new Error(\"Method override missing\");\n    }\n}","import EasePreset from \"../../gui/model/preset/EasePreset\";\nimport EasePresetProvider from \"../../gui/model/preset/EasePresetProvider\";\nimport CastEntry from \"./CastEntry\";\n\nclass InstanceCastEntry extends CastEntry {\n    constructor(thirdPartyEase, nativeEasePresetOrPresetProvider) {\n        super();\n        \n        this._thirdPartyEase = thirdPartyEase;\n        this._preset = this._parseNativePreset(nativeEasePresetOrPresetProvider);\n    }\n\n    get preset() {\n        return this._preset;\n    }\n\n    supportsCastInward(thirdPartyEase) {\n        return this._thirdPartyEase === thirdPartyEase && !!this._preset;\n    }\n\n    supportsCastOutward(nativeEasePreset) {\n        return this._preset.equals(nativeEasePreset) && !!this._thirdPartyEase;\n    }\n\n    castInward(thirdPartyEase) {\n        return this._preset;\n    }\n\n    castOutward(nativeEasePreset) {\n        return this._thirdPartyEase;\n    }\n\n    static of(thirdPartyEase, nativeEasePresetOrPresetProvider) {\n        return new InstanceCastEntry(...arguments);\n    }\n\n    _parseNativePreset(rawNativePreset) {\n        // instanceof seems broken after transpilation, added temporary signature checks\n        if (rawNativePreset instanceof EasePresetProvider || typeof rawNativePreset.next === \"function\") {\n            return rawNativePreset.next();\n        }\n        else if (rawNativePreset instanceof EasePreset || typeof rawNativePreset.clone === \"function\") {\n            return rawNativePreset.clone();\n        }\n        else {\n            console.warn(`Native preset or preset provider expected. Instead got `, rawNativePreset);\n        }\n    }\n}\n\nexport default InstanceCastEntry;","import EasePreset from \"../../gui/model/preset/EasePreset\";\nimport EasePresetProvider from \"../../gui/model/preset/EasePresetProvider\";\nimport CastEntry from \"./CastEntry\";\n\nclass PredicateCastEntry extends CastEntry {\n    constructor(predicateFunction, thirdPartyToNativeCast, nativeToThirdPartyCast, nativeEasePresetOrPresetProvider) {\n        super();\n\n        this._predicate = predicateFunction;\n        this._transformThirdPartyToNativeEase = thirdPartyToNativeCast;\n        this._transformNativeToThirdPartyEase = nativeToThirdPartyCast;\n        this._preset = this._parseNativePreset(nativeEasePresetOrPresetProvider);\n    }\n\n    get preset() {\n        return this._preset;\n    }\n\n    supportsCastInward(thirdPartyEase) {\n        return this._predicate(thirdPartyEase) && this._transformThirdPartyToNativeEase;\n    }\n\n    castInward(thirdPartyEase) {\n        const preset = this._preset.clone();\n        preset.ease = this._transformThirdPartyToNativeEase(thirdPartyEase);\n        return preset;\n    }\n\n    castOutward(nativeEasePreset) {\n        return this._transformNativeToThirdPartyEase(nativeEasePreset.ease);\n    }\n\n    static of(predicateFunction, thirdPartyToNativeCast, nativeToThirdPartyCast, nativeEasePresetOrPresetProvider) {\n        return new PredicateCastEntry(...arguments);\n    }\n\n    _parseNativePreset(rawNativePreset) {\n        // instanceof seems broken after transpilation, added temporary signature checks\n        if (rawNativePreset instanceof EasePresetProvider || typeof rawNativePreset.next === \"function\") {\n            return rawNativePreset.next();\n        }\n        else if (rawNativePreset instanceof EasePreset || typeof rawNativePreset.clone === \"function\") {\n            return rawNativePreset.clone();\n        }\n        else {\n            console.warn(`Native preset or preset provider expected. Instead got `, rawNativePreset);\n        }\n    }\n}\n\nexport default PredicateCastEntry;","import EasePreset, { Curve } from \"../../gui/model/preset/EasePreset\";\nimport CastEntry from \"./CastEntry\";\n\nclass TransformCastEntry extends CastEntry {\n    constructor(predicateFunction, thirdPartyToNativeCast, nativeToThirdPartyCast) {\n        super();\n\n        this._predicate = predicateFunction;\n        this._transformThirdPartyToNativeEase = thirdPartyToNativeCast;\n        this._transformNativeToThirdPartyEase = nativeToThirdPartyCast;\n    }\n\n    supportsCastInward(thirdPartyEase) {\n        return this._predicate(thirdPartyEase) && this._transformThirdPartyToNativeEase;\n    }\n\n    castInward(thirdPartyEase) {\n        return new EasePreset(this._transformThirdPartyToNativeEase(thirdPartyEase), Curve.CUSTOM);\n    }\n\n    castOutward(nativeEasePreset) {\n        return this._transformNativeToThirdPartyEase(nativeEasePreset.ease);\n    }\n\n    static of(predicateFunction, thirdPartyToNativeCast, nativeToThirdPartyCast) {\n        return new TransformCastEntry(...arguments);\n    }\n}\n\nexport default TransformCastEntry;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Bezier = void 0;\n// math-inlining.\nconst {\n  abs,\n  cos,\n  sin,\n  acos,\n  atan2,\n  sqrt,\n  pow\n} = Math; // cube root function yielding real roots\n\nfunction crt(v) {\n  return v < 0 ? -pow(-v, 1 / 3) : pow(v, 1 / 3);\n} // trig constants\n\n\nconst pi = Math.PI,\n      tau = 2 * pi,\n      quart = pi / 2,\n      // float precision significant decimal\nepsilon = 0.000001,\n      // extremas used in bbox calculation and similar algorithms\nnMax = Number.MAX_SAFE_INTEGER || 9007199254740991,\n      nMin = Number.MIN_SAFE_INTEGER || -9007199254740991,\n      // a zero coordinate, which is surprisingly useful\nZERO = {\n  x: 0,\n  y: 0,\n  z: 0\n}; // Bezier utility functions\n\nconst utils = {\n  // Legendre-Gauss abscissae with n=24 (x_i values, defined at i=n as the roots of the nth order Legendre polynomial Pn(x))\n  Tvalues: [-0.0640568928626056260850430826247450385909, 0.0640568928626056260850430826247450385909, -0.1911188674736163091586398207570696318404, 0.1911188674736163091586398207570696318404, -0.3150426796961633743867932913198102407864, 0.3150426796961633743867932913198102407864, -0.4337935076260451384870842319133497124524, 0.4337935076260451384870842319133497124524, -0.5454214713888395356583756172183723700107, 0.5454214713888395356583756172183723700107, -0.6480936519369755692524957869107476266696, 0.6480936519369755692524957869107476266696, -0.7401241915785543642438281030999784255232, 0.7401241915785543642438281030999784255232, -0.8200019859739029219539498726697452080761, 0.8200019859739029219539498726697452080761, -0.8864155270044010342131543419821967550873, 0.8864155270044010342131543419821967550873, -0.9382745520027327585236490017087214496548, 0.9382745520027327585236490017087214496548, -0.9747285559713094981983919930081690617411, 0.9747285559713094981983919930081690617411, -0.9951872199970213601799974097007368118745, 0.9951872199970213601799974097007368118745],\n  // Legendre-Gauss weights with n=24 (w_i values, defined by a function linked to in the Bezier primer article)\n  Cvalues: [0.1279381953467521569740561652246953718517, 0.1279381953467521569740561652246953718517, 0.1258374563468282961213753825111836887264, 0.1258374563468282961213753825111836887264, 0.121670472927803391204463153476262425607, 0.121670472927803391204463153476262425607, 0.1155056680537256013533444839067835598622, 0.1155056680537256013533444839067835598622, 0.1074442701159656347825773424466062227946, 0.1074442701159656347825773424466062227946, 0.0976186521041138882698806644642471544279, 0.0976186521041138882698806644642471544279, 0.086190161531953275917185202983742667185, 0.086190161531953275917185202983742667185, 0.0733464814110803057340336152531165181193, 0.0733464814110803057340336152531165181193, 0.0592985849154367807463677585001085845412, 0.0592985849154367807463677585001085845412, 0.0442774388174198061686027482113382288593, 0.0442774388174198061686027482113382288593, 0.0285313886289336631813078159518782864491, 0.0285313886289336631813078159518782864491, 0.0123412297999871995468056670700372915759, 0.0123412297999871995468056670700372915759],\n  arcfn: function (t, derivativeFn) {\n    const d = derivativeFn(t);\n    let l = d.x * d.x + d.y * d.y;\n\n    if (typeof d.z !== \"undefined\") {\n      l += d.z * d.z;\n    }\n\n    return sqrt(l);\n  },\n  compute: function (t, points, _3d) {\n    // shortcuts\n    if (t === 0) {\n      points[0].t = 0;\n      return points[0];\n    }\n\n    const order = points.length - 1;\n\n    if (t === 1) {\n      points[order].t = 1;\n      return points[order];\n    }\n\n    const mt = 1 - t;\n    let p = points; // constant?\n\n    if (order === 0) {\n      points[0].t = t;\n      return points[0];\n    } // linear?\n\n\n    if (order === 1) {\n      const ret = {\n        x: mt * p[0].x + t * p[1].x,\n        y: mt * p[0].y + t * p[1].y,\n        t: t\n      };\n\n      if (_3d) {\n        ret.z = mt * p[0].z + t * p[1].z;\n      }\n\n      return ret;\n    } // quadratic/cubic curve?\n\n\n    if (order < 4) {\n      let mt2 = mt * mt,\n          t2 = t * t,\n          a,\n          b,\n          c,\n          d = 0;\n\n      if (order === 2) {\n        p = [p[0], p[1], p[2], ZERO];\n        a = mt2;\n        b = mt * t * 2;\n        c = t2;\n      } else if (order === 3) {\n        a = mt2 * mt;\n        b = mt2 * t * 3;\n        c = mt * t2 * 3;\n        d = t * t2;\n      }\n\n      const ret = {\n        x: a * p[0].x + b * p[1].x + c * p[2].x + d * p[3].x,\n        y: a * p[0].y + b * p[1].y + c * p[2].y + d * p[3].y,\n        t: t\n      };\n\n      if (_3d) {\n        ret.z = a * p[0].z + b * p[1].z + c * p[2].z + d * p[3].z;\n      }\n\n      return ret;\n    } // higher order curves: use de Casteljau's computation\n\n\n    const dCpts = JSON.parse(JSON.stringify(points));\n\n    while (dCpts.length > 1) {\n      for (let i = 0; i < dCpts.length - 1; i++) {\n        dCpts[i] = {\n          x: dCpts[i].x + (dCpts[i + 1].x - dCpts[i].x) * t,\n          y: dCpts[i].y + (dCpts[i + 1].y - dCpts[i].y) * t\n        };\n\n        if (typeof dCpts[i].z !== \"undefined\") {\n          dCpts[i] = dCpts[i].z + (dCpts[i + 1].z - dCpts[i].z) * t;\n        }\n      }\n\n      dCpts.splice(dCpts.length - 1, 1);\n    }\n\n    dCpts[0].t = t;\n    return dCpts[0];\n  },\n  computeWithRatios: function (t, points, ratios, _3d) {\n    const mt = 1 - t,\n          r = ratios,\n          p = points;\n    let f1 = r[0],\n        f2 = r[1],\n        f3 = r[2],\n        f4 = r[3],\n        d; // spec for linear\n\n    f1 *= mt;\n    f2 *= t;\n\n    if (p.length === 2) {\n      d = f1 + f2;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y) / d,\n        z: !_3d ? false : (f1 * p[0].z + f2 * p[1].z) / d,\n        t: t\n      };\n    } // upgrade to quadratic\n\n\n    f1 *= mt;\n    f2 *= 2 * mt;\n    f3 *= t * t;\n\n    if (p.length === 3) {\n      d = f1 + f2 + f3;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x + f3 * p[2].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y + f3 * p[2].y) / d,\n        z: !_3d ? false : (f1 * p[0].z + f2 * p[1].z + f3 * p[2].z) / d,\n        t: t\n      };\n    } // upgrade to cubic\n\n\n    f1 *= mt;\n    f2 *= 1.5 * mt;\n    f3 *= 3 * mt;\n    f4 *= t * t * t;\n\n    if (p.length === 4) {\n      d = f1 + f2 + f3 + f4;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x + f3 * p[2].x + f4 * p[3].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y + f3 * p[2].y + f4 * p[3].y) / d,\n        z: !_3d ? false : (f1 * p[0].z + f2 * p[1].z + f3 * p[2].z + f4 * p[3].z) / d,\n        t: t\n      };\n    }\n  },\n  derive: function (points, _3d) {\n    const dpoints = [];\n\n    for (let p = points, d = p.length, c = d - 1; d > 1; d--, c--) {\n      const list = [];\n\n      for (let j = 0, dpt; j < c; j++) {\n        dpt = {\n          x: c * (p[j + 1].x - p[j].x),\n          y: c * (p[j + 1].y - p[j].y)\n        };\n\n        if (_3d) {\n          dpt.z = c * (p[j + 1].z - p[j].z);\n        }\n\n        list.push(dpt);\n      }\n\n      dpoints.push(list);\n      p = list;\n    }\n\n    return dpoints;\n  },\n  between: function (v, m, M) {\n    return m <= v && v <= M || utils.approximately(v, m) || utils.approximately(v, M);\n  },\n  approximately: function (a, b, precision) {\n    return abs(a - b) <= (precision || epsilon);\n  },\n  length: function (derivativeFn) {\n    const z = 0.5,\n          len = utils.Tvalues.length;\n    let sum = 0;\n\n    for (let i = 0, t; i < len; i++) {\n      t = z * utils.Tvalues[i] + z;\n      sum += utils.Cvalues[i] * utils.arcfn(t, derivativeFn);\n    }\n\n    return z * sum;\n  },\n  map: function (v, ds, de, ts, te) {\n    const d1 = de - ds,\n          d2 = te - ts,\n          v2 = v - ds,\n          r = v2 / d1;\n    return ts + d2 * r;\n  },\n  lerp: function (r, v1, v2) {\n    const ret = {\n      x: v1.x + r * (v2.x - v1.x),\n      y: v1.y + r * (v2.y - v1.y)\n    };\n\n    if (v1.z !== undefined && v2.z !== undefined) {\n      ret.z = v1.z + r * (v2.z - v1.z);\n    }\n\n    return ret;\n  },\n  pointToString: function (p) {\n    let s = p.x + \"/\" + p.y;\n\n    if (typeof p.z !== \"undefined\") {\n      s += \"/\" + p.z;\n    }\n\n    return s;\n  },\n  pointsToString: function (points) {\n    return \"[\" + points.map(utils.pointToString).join(\", \") + \"]\";\n  },\n  copy: function (obj) {\n    return JSON.parse(JSON.stringify(obj));\n  },\n  angle: function (o, v1, v2) {\n    const dx1 = v1.x - o.x,\n          dy1 = v1.y - o.y,\n          dx2 = v2.x - o.x,\n          dy2 = v2.y - o.y,\n          cross = dx1 * dy2 - dy1 * dx2,\n          dot = dx1 * dx2 + dy1 * dy2;\n    return atan2(cross, dot);\n  },\n  // round as string, to avoid rounding errors\n  round: function (v, d) {\n    const s = \"\" + v;\n    const pos = s.indexOf(\".\");\n    return parseFloat(s.substring(0, pos + 1 + d));\n  },\n  dist: function (p1, p2) {\n    const dx = p1.x - p2.x,\n          dy = p1.y - p2.y;\n    return sqrt(dx * dx + dy * dy);\n  },\n  closest: function (LUT, point) {\n    let mdist = pow(2, 63),\n        mpos,\n        d;\n    LUT.forEach(function (p, idx) {\n      d = utils.dist(point, p);\n\n      if (d < mdist) {\n        mdist = d;\n        mpos = idx;\n      }\n    });\n    return {\n      mdist: mdist,\n      mpos: mpos\n    };\n  },\n  abcratio: function (t, n) {\n    // see ratio(t) note on http://pomax.github.io/bezierinfo/#abc\n    if (n !== 2 && n !== 3) {\n      return false;\n    }\n\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    } else if (t === 0 || t === 1) {\n      return t;\n    }\n\n    const bottom = pow(t, n) + pow(1 - t, n),\n          top = bottom - 1;\n    return abs(top / bottom);\n  },\n  projectionratio: function (t, n) {\n    // see u(t) note on http://pomax.github.io/bezierinfo/#abc\n    if (n !== 2 && n !== 3) {\n      return false;\n    }\n\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    } else if (t === 0 || t === 1) {\n      return t;\n    }\n\n    const top = pow(1 - t, n),\n          bottom = pow(t, n) + top;\n    return top / bottom;\n  },\n  lli8: function (x1, y1, x2, y2, x3, y3, x4, y4) {\n    const nx = (x1 * y2 - y1 * x2) * (x3 - x4) - (x1 - x2) * (x3 * y4 - y3 * x4),\n          ny = (x1 * y2 - y1 * x2) * (y3 - y4) - (y1 - y2) * (x3 * y4 - y3 * x4),\n          d = (x1 - x2) * (y3 - y4) - (y1 - y2) * (x3 - x4);\n\n    if (d == 0) {\n      return false;\n    }\n\n    return {\n      x: nx / d,\n      y: ny / d\n    };\n  },\n  lli4: function (p1, p2, p3, p4) {\n    const x1 = p1.x,\n          y1 = p1.y,\n          x2 = p2.x,\n          y2 = p2.y,\n          x3 = p3.x,\n          y3 = p3.y,\n          x4 = p4.x,\n          y4 = p4.y;\n    return utils.lli8(x1, y1, x2, y2, x3, y3, x4, y4);\n  },\n  lli: function (v1, v2) {\n    return utils.lli4(v1, v1.c, v2, v2.c);\n  },\n  makeline: function (p1, p2) {\n    return new Bezier(p1.x, p1.y, (p1.x + p2.x) / 2, (p1.y + p2.y) / 2, p2.x, p2.y);\n  },\n  findbbox: function (sections) {\n    let mx = nMax,\n        my = nMax,\n        MX = nMin,\n        MY = nMin;\n    sections.forEach(function (s) {\n      const bbox = s.bbox();\n      if (mx > bbox.x.min) mx = bbox.x.min;\n      if (my > bbox.y.min) my = bbox.y.min;\n      if (MX < bbox.x.max) MX = bbox.x.max;\n      if (MY < bbox.y.max) MY = bbox.y.max;\n    });\n    return {\n      x: {\n        min: mx,\n        mid: (mx + MX) / 2,\n        max: MX,\n        size: MX - mx\n      },\n      y: {\n        min: my,\n        mid: (my + MY) / 2,\n        max: MY,\n        size: MY - my\n      }\n    };\n  },\n  shapeintersections: function (s1, bbox1, s2, bbox2, curveIntersectionThreshold) {\n    if (!utils.bboxoverlap(bbox1, bbox2)) return [];\n    const intersections = [];\n    const a1 = [s1.startcap, s1.forward, s1.back, s1.endcap];\n    const a2 = [s2.startcap, s2.forward, s2.back, s2.endcap];\n    a1.forEach(function (l1) {\n      if (l1.virtual) return;\n      a2.forEach(function (l2) {\n        if (l2.virtual) return;\n        const iss = l1.intersects(l2, curveIntersectionThreshold);\n\n        if (iss.length > 0) {\n          iss.c1 = l1;\n          iss.c2 = l2;\n          iss.s1 = s1;\n          iss.s2 = s2;\n          intersections.push(iss);\n        }\n      });\n    });\n    return intersections;\n  },\n  makeshape: function (forward, back, curveIntersectionThreshold) {\n    const bpl = back.points.length;\n    const fpl = forward.points.length;\n    const start = utils.makeline(back.points[bpl - 1], forward.points[0]);\n    const end = utils.makeline(forward.points[fpl - 1], back.points[0]);\n    const shape = {\n      startcap: start,\n      forward: forward,\n      back: back,\n      endcap: end,\n      bbox: utils.findbbox([start, forward, back, end])\n    };\n\n    shape.intersections = function (s2) {\n      return utils.shapeintersections(shape, shape.bbox, s2, s2.bbox, curveIntersectionThreshold);\n    };\n\n    return shape;\n  },\n  getminmax: function (curve, d, list) {\n    if (!list) return {\n      min: 0,\n      max: 0\n    };\n    let min = nMax,\n        max = nMin,\n        t,\n        c;\n\n    if (list.indexOf(0) === -1) {\n      list = [0].concat(list);\n    }\n\n    if (list.indexOf(1) === -1) {\n      list.push(1);\n    }\n\n    for (let i = 0, len = list.length; i < len; i++) {\n      t = list[i];\n      c = curve.get(t);\n\n      if (c[d] < min) {\n        min = c[d];\n      }\n\n      if (c[d] > max) {\n        max = c[d];\n      }\n    }\n\n    return {\n      min: min,\n      mid: (min + max) / 2,\n      max: max,\n      size: max - min\n    };\n  },\n  align: function (points, line) {\n    const tx = line.p1.x,\n          ty = line.p1.y,\n          a = -atan2(line.p2.y - ty, line.p2.x - tx),\n          d = function (v) {\n      return {\n        x: (v.x - tx) * cos(a) - (v.y - ty) * sin(a),\n        y: (v.x - tx) * sin(a) + (v.y - ty) * cos(a)\n      };\n    };\n\n    return points.map(d);\n  },\n  roots: function (points, line) {\n    line = line || {\n      p1: {\n        x: 0,\n        y: 0\n      },\n      p2: {\n        x: 1,\n        y: 0\n      }\n    };\n    const order = points.length - 1;\n    const aligned = utils.align(points, line);\n\n    const reduce = function (t) {\n      return 0 <= t && t <= 1;\n    };\n\n    if (order === 2) {\n      const a = aligned[0].y,\n            b = aligned[1].y,\n            c = aligned[2].y,\n            d = a - 2 * b + c;\n\n      if (d !== 0) {\n        const m1 = -sqrt(b * b - a * c),\n              m2 = -a + b,\n              v1 = -(m1 + m2) / d,\n              v2 = -(-m1 + m2) / d;\n        return [v1, v2].filter(reduce);\n      } else if (b !== c && d === 0) {\n        return [(2 * b - c) / (2 * b - 2 * c)].filter(reduce);\n      }\n\n      return [];\n    } // see http://www.trans4mind.com/personal_development/mathematics/polynomials/cubicAlgebra.htm\n\n\n    const pa = aligned[0].y,\n          pb = aligned[1].y,\n          pc = aligned[2].y,\n          pd = aligned[3].y;\n    let d = -pa + 3 * pb - 3 * pc + pd,\n        a = 3 * pa - 6 * pb + 3 * pc,\n        b = -3 * pa + 3 * pb,\n        c = pa;\n\n    if (utils.approximately(d, 0)) {\n      // this is not a cubic curve.\n      if (utils.approximately(a, 0)) {\n        // in fact, this is not a quadratic curve either.\n        if (utils.approximately(b, 0)) {\n          // in fact in fact, there are no solutions.\n          return [];\n        } // linear solution:\n\n\n        return [-c / b].filter(reduce);\n      } // quadratic solution:\n\n\n      const q = sqrt(b * b - 4 * a * c),\n            a2 = 2 * a;\n      return [(q - b) / a2, (-b - q) / a2].filter(reduce);\n    } // at this point, we know we need a cubic solution:\n\n\n    a /= d;\n    b /= d;\n    c /= d;\n    const p = (3 * b - a * a) / 3,\n          p3 = p / 3,\n          q = (2 * a * a * a - 9 * a * b + 27 * c) / 27,\n          q2 = q / 2,\n          discriminant = q2 * q2 + p3 * p3 * p3;\n    let u1, v1, x1, x2, x3;\n\n    if (discriminant < 0) {\n      const mp3 = -p / 3,\n            mp33 = mp3 * mp3 * mp3,\n            r = sqrt(mp33),\n            t = -q / (2 * r),\n            cosphi = t < -1 ? -1 : t > 1 ? 1 : t,\n            phi = acos(cosphi),\n            crtr = crt(r),\n            t1 = 2 * crtr;\n      x1 = t1 * cos(phi / 3) - a / 3;\n      x2 = t1 * cos((phi + tau) / 3) - a / 3;\n      x3 = t1 * cos((phi + 2 * tau) / 3) - a / 3;\n      return [x1, x2, x3].filter(reduce);\n    } else if (discriminant === 0) {\n      u1 = q2 < 0 ? crt(-q2) : -crt(q2);\n      x1 = 2 * u1 - a / 3;\n      x2 = -u1 - a / 3;\n      return [x1, x2].filter(reduce);\n    } else {\n      const sd = sqrt(discriminant);\n      u1 = crt(-q2 + sd);\n      v1 = crt(q2 + sd);\n      return [u1 - v1 - a / 3].filter(reduce);\n    }\n  },\n  droots: function (p) {\n    // quadratic roots are easy\n    if (p.length === 3) {\n      const a = p[0],\n            b = p[1],\n            c = p[2],\n            d = a - 2 * b + c;\n\n      if (d !== 0) {\n        const m1 = -sqrt(b * b - a * c),\n              m2 = -a + b,\n              v1 = -(m1 + m2) / d,\n              v2 = -(-m1 + m2) / d;\n        return [v1, v2];\n      } else if (b !== c && d === 0) {\n        return [(2 * b - c) / (2 * (b - c))];\n      }\n\n      return [];\n    } // linear roots are even easier\n\n\n    if (p.length === 2) {\n      const a = p[0],\n            b = p[1];\n\n      if (a !== b) {\n        return [a / (a - b)];\n      }\n\n      return [];\n    }\n\n    return [];\n  },\n  curvature: function (t, d1, d2, _3d, kOnly) {\n    let num,\n        dnm,\n        adk,\n        dk,\n        k = 0,\n        r = 0; //\n    // We're using the following formula for curvature:\n    //\n    //              x'y\" - y'x\"\n    //   k(t) = ------------------\n    //           (x' + y')^(3/2)\n    //\n    // from https://en.wikipedia.org/wiki/Radius_of_curvature#Definition\n    //\n    // With it corresponding 3D counterpart:\n    //\n    //          sqrt( (y'z\" - y\"z') + (z'x\" - z\"x') + (x'y\" - x\"y'))\n    //   k(t) = -------------------------------------------------------\n    //                     (x' + y' + z')^(3/2)\n    //\n\n    const d = utils.compute(t, d1);\n    const dd = utils.compute(t, d2);\n    const qdsum = d.x * d.x + d.y * d.y;\n\n    if (_3d) {\n      num = sqrt(pow(d.y * dd.z - dd.y * d.z, 2) + pow(d.z * dd.x - dd.z * d.x, 2) + pow(d.x * dd.y - dd.x * d.y, 2));\n      dnm = pow(qdsum + d.z * d.z, 3 / 2);\n    } else {\n      num = d.x * dd.y - d.y * dd.x;\n      dnm = pow(qdsum, 3 / 2);\n    }\n\n    if (num === 0 || dnm === 0) {\n      return {\n        k: 0,\n        r: 0\n      };\n    }\n\n    k = num / dnm;\n    r = dnm / num; // We're also computing the derivative of kappa, because\n    // there is value in knowing the rate of change for the\n    // curvature along the curve. And we're just going to\n    // ballpark it based on an epsilon.\n\n    if (!kOnly) {\n      // compute k'(t) based on the interval before, and after it,\n      // to at least try to not introduce forward/backward pass bias.\n      const pk = utils.curvature(t - 0.001, d1, d2, _3d, true).k;\n      const nk = utils.curvature(t + 0.001, d1, d2, _3d, true).k;\n      dk = (nk - k + (k - pk)) / 2;\n      adk = (abs(nk - k) + abs(k - pk)) / 2;\n    }\n\n    return {\n      k: k,\n      r: r,\n      dk: dk,\n      adk: adk\n    };\n  },\n  inflections: function (points) {\n    if (points.length < 4) return []; // FIXME: TODO: add in inflection abstraction for quartic+ curves?\n\n    const p = utils.align(points, {\n      p1: points[0],\n      p2: points.slice(-1)[0]\n    }),\n          a = p[2].x * p[1].y,\n          b = p[3].x * p[1].y,\n          c = p[1].x * p[2].y,\n          d = p[3].x * p[2].y,\n          v1 = 18 * (-3 * a + 2 * b + 3 * c - d),\n          v2 = 18 * (3 * a - b - 3 * c),\n          v3 = 18 * (c - a);\n\n    if (utils.approximately(v1, 0)) {\n      if (!utils.approximately(v2, 0)) {\n        let t = -v3 / v2;\n        if (0 <= t && t <= 1) return [t];\n      }\n\n      return [];\n    }\n\n    const trm = v2 * v2 - 4 * v1 * v3,\n          sq = Math.sqrt(trm),\n          d2 = 2 * v1;\n    if (utils.approximately(d2, 0)) return [];\n    return [(sq - v2) / d2, -(v2 + sq) / d2].filter(function (r) {\n      return 0 <= r && r <= 1;\n    });\n  },\n  bboxoverlap: function (b1, b2) {\n    const dims = [\"x\", \"y\"],\n          len = dims.length;\n\n    for (let i = 0, dim, l, t, d; i < len; i++) {\n      dim = dims[i];\n      l = b1[dim].mid;\n      t = b2[dim].mid;\n      d = (b1[dim].size + b2[dim].size) / 2;\n      if (abs(l - t) >= d) return false;\n    }\n\n    return true;\n  },\n  expandbox: function (bbox, _bbox) {\n    if (_bbox.x.min < bbox.x.min) {\n      bbox.x.min = _bbox.x.min;\n    }\n\n    if (_bbox.y.min < bbox.y.min) {\n      bbox.y.min = _bbox.y.min;\n    }\n\n    if (_bbox.z && _bbox.z.min < bbox.z.min) {\n      bbox.z.min = _bbox.z.min;\n    }\n\n    if (_bbox.x.max > bbox.x.max) {\n      bbox.x.max = _bbox.x.max;\n    }\n\n    if (_bbox.y.max > bbox.y.max) {\n      bbox.y.max = _bbox.y.max;\n    }\n\n    if (_bbox.z && _bbox.z.max > bbox.z.max) {\n      bbox.z.max = _bbox.z.max;\n    }\n\n    bbox.x.mid = (bbox.x.min + bbox.x.max) / 2;\n    bbox.y.mid = (bbox.y.min + bbox.y.max) / 2;\n\n    if (bbox.z) {\n      bbox.z.mid = (bbox.z.min + bbox.z.max) / 2;\n    }\n\n    bbox.x.size = bbox.x.max - bbox.x.min;\n    bbox.y.size = bbox.y.max - bbox.y.min;\n\n    if (bbox.z) {\n      bbox.z.size = bbox.z.max - bbox.z.min;\n    }\n  },\n  pairiteration: function (c1, c2, curveIntersectionThreshold) {\n    const c1b = c1.bbox(),\n          c2b = c2.bbox(),\n          r = 100000,\n          threshold = curveIntersectionThreshold || 0.5;\n\n    if (c1b.x.size + c1b.y.size < threshold && c2b.x.size + c2b.y.size < threshold) {\n      return [(r * (c1._t1 + c1._t2) / 2 | 0) / r + \"/\" + (r * (c2._t1 + c2._t2) / 2 | 0) / r];\n    }\n\n    let cc1 = c1.split(0.5),\n        cc2 = c2.split(0.5),\n        pairs = [{\n      left: cc1.left,\n      right: cc2.left\n    }, {\n      left: cc1.left,\n      right: cc2.right\n    }, {\n      left: cc1.right,\n      right: cc2.right\n    }, {\n      left: cc1.right,\n      right: cc2.left\n    }];\n    pairs = pairs.filter(function (pair) {\n      return utils.bboxoverlap(pair.left.bbox(), pair.right.bbox());\n    });\n    let results = [];\n    if (pairs.length === 0) return results;\n    pairs.forEach(function (pair) {\n      results = results.concat(utils.pairiteration(pair.left, pair.right, threshold));\n    });\n    results = results.filter(function (v, i) {\n      return results.indexOf(v) === i;\n    });\n    return results;\n  },\n  getccenter: function (p1, p2, p3) {\n    const dx1 = p2.x - p1.x,\n          dy1 = p2.y - p1.y,\n          dx2 = p3.x - p2.x,\n          dy2 = p3.y - p2.y,\n          dx1p = dx1 * cos(quart) - dy1 * sin(quart),\n          dy1p = dx1 * sin(quart) + dy1 * cos(quart),\n          dx2p = dx2 * cos(quart) - dy2 * sin(quart),\n          dy2p = dx2 * sin(quart) + dy2 * cos(quart),\n          // chord midpoints\n    mx1 = (p1.x + p2.x) / 2,\n          my1 = (p1.y + p2.y) / 2,\n          mx2 = (p2.x + p3.x) / 2,\n          my2 = (p2.y + p3.y) / 2,\n          // midpoint offsets\n    mx1n = mx1 + dx1p,\n          my1n = my1 + dy1p,\n          mx2n = mx2 + dx2p,\n          my2n = my2 + dy2p,\n          // intersection of these lines:\n    arc = utils.lli8(mx1, my1, mx1n, my1n, mx2, my2, mx2n, my2n),\n          r = utils.dist(arc, p1); // arc start/end values, over mid point:\n\n    let s = atan2(p1.y - arc.y, p1.x - arc.x),\n        m = atan2(p2.y - arc.y, p2.x - arc.x),\n        e = atan2(p3.y - arc.y, p3.x - arc.x),\n        _; // determine arc direction (cw/ccw correction)\n\n\n    if (s < e) {\n      // if s<m<e, arc(s, e)\n      // if m<s<e, arc(e, s + tau)\n      // if s<e<m, arc(e, s + tau)\n      if (s > m || m > e) {\n        s += tau;\n      }\n\n      if (s > e) {\n        _ = e;\n        e = s;\n        s = _;\n      }\n    } else {\n      // if e<m<s, arc(e, s)\n      // if m<e<s, arc(s, e + tau)\n      // if e<s<m, arc(s, e + tau)\n      if (e < m && m < s) {\n        _ = e;\n        e = s;\n        s = _;\n      } else {\n        e += tau;\n      }\n    } // assign and done.\n\n\n    arc.s = s;\n    arc.e = e;\n    arc.r = r;\n    return arc;\n  },\n  numberSort: function (a, b) {\n    return a - b;\n  }\n};\n/**\n * Poly Bezier\n * @param {[type]} curves [description]\n */\n\nclass PolyBezier {\n  constructor(curves) {\n    this.curves = [];\n    this._3d = false;\n\n    if (!!curves) {\n      this.curves = curves;\n      this._3d = this.curves[0]._3d;\n    }\n  }\n\n  valueOf() {\n    return this.toString();\n  }\n\n  toString() {\n    return \"[\" + this.curves.map(function (curve) {\n      return utils.pointsToString(curve.points);\n    }).join(\", \") + \"]\";\n  }\n\n  addCurve(curve) {\n    this.curves.push(curve);\n    this._3d = this._3d || curve._3d;\n  }\n\n  length() {\n    return this.curves.map(function (v) {\n      return v.length();\n    }).reduce(function (a, b) {\n      return a + b;\n    });\n  }\n\n  curve(idx) {\n    return this.curves[idx];\n  }\n\n  bbox() {\n    const c = this.curves;\n    var bbox = c[0].bbox();\n\n    for (var i = 1; i < c.length; i++) {\n      utils.expandbox(bbox, c[i].bbox());\n    }\n\n    return bbox;\n  }\n\n  offset(d) {\n    const offset = [];\n    this.curves.forEach(function (v) {\n      offset.push(...v.offset(d));\n    });\n    return new PolyBezier(offset);\n  }\n\n}\n/**\n  A javascript Bezier curve library by Pomax.\n\n  Based on http://pomax.github.io/bezierinfo\n\n  This code is MIT licensed.\n**/\n// math-inlining.\n\n\nconst {\n  abs: abs$1,\n  min,\n  max,\n  cos: cos$1,\n  sin: sin$1,\n  acos: acos$1,\n  sqrt: sqrt$1\n} = Math;\nconst pi$1 = Math.PI;\n/**\n * Bezier curve constructor.\n *\n * ...docs pending...\n */\n\nclass Bezier {\n  constructor(coords) {\n    let args = coords && coords.forEach ? coords : Array.from(arguments).slice();\n    let coordlen = false;\n\n    if (typeof args[0] === \"object\") {\n      coordlen = args.length;\n      const newargs = [];\n      args.forEach(function (point) {\n        [\"x\", \"y\", \"z\"].forEach(function (d) {\n          if (typeof point[d] !== \"undefined\") {\n            newargs.push(point[d]);\n          }\n        });\n      });\n      args = newargs;\n    }\n\n    let higher = false;\n    const len = args.length;\n\n    if (coordlen) {\n      if (coordlen > 4) {\n        if (arguments.length !== 1) {\n          throw new Error(\"Only new Bezier(point[]) is accepted for 4th and higher order curves\");\n        }\n\n        higher = true;\n      }\n    } else {\n      if (len !== 6 && len !== 8 && len !== 9 && len !== 12) {\n        if (arguments.length !== 1) {\n          throw new Error(\"Only new Bezier(point[]) is accepted for 4th and higher order curves\");\n        }\n      }\n    }\n\n    const _3d = this._3d = !higher && (len === 9 || len === 12) || coords && coords[0] && typeof coords[0].z !== \"undefined\";\n\n    const points = this.points = [];\n\n    for (let idx = 0, step = _3d ? 3 : 2; idx < len; idx += step) {\n      var point = {\n        x: args[idx],\n        y: args[idx + 1]\n      };\n\n      if (_3d) {\n        point.z = args[idx + 2];\n      }\n\n      points.push(point);\n    }\n\n    const order = this.order = points.length - 1;\n    const dims = this.dims = [\"x\", \"y\"];\n    if (_3d) dims.push(\"z\");\n    this.dimlen = dims.length; // is this curve, practically speaking, a straight line?\n\n    const aligned = utils.align(points, {\n      p1: points[0],\n      p2: points[order]\n    });\n    const baselength = utils.dist(points[0], points[order]);\n    this._linear = aligned.reduce((t, p) => t + abs$1(p.y), 0) < baselength / 50;\n    this._lut = [];\n    this._t1 = 0;\n    this._t2 = 1;\n    this.update();\n  }\n\n  static quadraticFromPoints(p1, p2, p3, t) {\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    } // shortcuts, although they're really dumb\n\n\n    if (t === 0) {\n      return new Bezier(p2, p2, p3);\n    }\n\n    if (t === 1) {\n      return new Bezier(p1, p2, p2);\n    } // real fitting.\n\n\n    const abc = Bezier.getABC(2, p1, p2, p3, t);\n    return new Bezier(p1, abc.A, p3);\n  }\n\n  static cubicFromPoints(S, B, E, t, d1) {\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    }\n\n    const abc = Bezier.getABC(3, S, B, E, t);\n\n    if (typeof d1 === \"undefined\") {\n      d1 = utils.dist(B, abc.C);\n    }\n\n    const d2 = d1 * (1 - t) / t;\n    const selen = utils.dist(S, E),\n          lx = (E.x - S.x) / selen,\n          ly = (E.y - S.y) / selen,\n          bx1 = d1 * lx,\n          by1 = d1 * ly,\n          bx2 = d2 * lx,\n          by2 = d2 * ly; // derivation of new hull coordinates\n\n    const e1 = {\n      x: B.x - bx1,\n      y: B.y - by1\n    },\n          e2 = {\n      x: B.x + bx2,\n      y: B.y + by2\n    },\n          A = abc.A,\n          v1 = {\n      x: A.x + (e1.x - A.x) / (1 - t),\n      y: A.y + (e1.y - A.y) / (1 - t)\n    },\n          v2 = {\n      x: A.x + (e2.x - A.x) / t,\n      y: A.y + (e2.y - A.y) / t\n    },\n          nc1 = {\n      x: S.x + (v1.x - S.x) / t,\n      y: S.y + (v1.y - S.y) / t\n    },\n          nc2 = {\n      x: E.x + (v2.x - E.x) / (1 - t),\n      y: E.y + (v2.y - E.y) / (1 - t)\n    }; // ...done\n\n    return new Bezier(S, nc1, nc2, E);\n  }\n\n  static getUtils() {\n    return utils;\n  }\n\n  getUtils() {\n    return Bezier.getUtils();\n  }\n\n  static get PolyBezier() {\n    return PolyBezier;\n  }\n\n  valueOf() {\n    return this.toString();\n  }\n\n  toString() {\n    return utils.pointsToString(this.points);\n  }\n\n  toSVG() {\n    if (this._3d) return false;\n    const p = this.points,\n          x = p[0].x,\n          y = p[0].y,\n          s = [\"M\", x, y, this.order === 2 ? \"Q\" : \"C\"];\n\n    for (let i = 1, last = p.length; i < last; i++) {\n      s.push(p[i].x);\n      s.push(p[i].y);\n    }\n\n    return s.join(\" \");\n  }\n\n  setRatios(ratios) {\n    if (ratios.length !== this.points.length) {\n      throw new Error(\"incorrect number of ratio values\");\n    }\n\n    this.ratios = ratios;\n    this._lut = []; //  invalidate any precomputed LUT\n  }\n\n  verify() {\n    const print = this.coordDigest();\n\n    if (print !== this._print) {\n      this._print = print;\n      this.update();\n    }\n  }\n\n  coordDigest() {\n    return this.points.map(function (c, pos) {\n      return \"\" + pos + c.x + c.y + (c.z ? c.z : 0);\n    }).join(\"\");\n  }\n\n  update() {\n    // invalidate any precomputed LUT\n    this._lut = [];\n    this.dpoints = utils.derive(this.points, this._3d);\n    this.computedirection();\n  }\n\n  computedirection() {\n    const points = this.points;\n    const angle = utils.angle(points[0], points[this.order], points[1]);\n    this.clockwise = angle > 0;\n  }\n\n  length() {\n    return utils.length(this.derivative.bind(this));\n  }\n\n  static getABC(order = 2, S, B, E, t = 0.5) {\n    const u = utils.projectionratio(t, order),\n          um = 1 - u,\n          C = {\n      x: u * S.x + um * E.x,\n      y: u * S.y + um * E.y\n    },\n          s = utils.abcratio(t, order),\n          A = {\n      x: B.x + (B.x - C.x) / s,\n      y: B.y + (B.y - C.y) / s\n    };\n    return {\n      A,\n      B,\n      C,\n      S,\n      E\n    };\n  }\n\n  getABC(t, B) {\n    B = B || this.get(t);\n    let S = this.points[0];\n    let E = this.points[this.order];\n    return Bezier.getABC(this.order, S, B, E, t);\n  }\n\n  getLUT(steps) {\n    this.verify();\n    steps = steps || 100;\n\n    if (this._lut.length === steps) {\n      return this._lut;\n    }\n\n    this._lut = []; // n steps means n+1 points\n\n    steps++;\n    this._lut = [];\n\n    for (let i = 0, p, t; i < steps; i++) {\n      t = i / (steps - 1);\n      p = this.compute(t);\n      p.t = t;\n\n      this._lut.push(p);\n    }\n\n    return this._lut;\n  }\n\n  on(point, error) {\n    error = error || 5;\n    const lut = this.getLUT(),\n          hits = [];\n\n    for (let i = 0, c, t = 0; i < lut.length; i++) {\n      c = lut[i];\n\n      if (utils.dist(c, point) < error) {\n        hits.push(c);\n        t += i / lut.length;\n      }\n    }\n\n    if (!hits.length) return false;\n    return t /= hits.length;\n  }\n\n  project(point) {\n    // step 1: coarse check\n    const LUT = this.getLUT(),\n          l = LUT.length - 1,\n          closest = utils.closest(LUT, point),\n          mpos = closest.mpos,\n          t1 = (mpos - 1) / l,\n          t2 = (mpos + 1) / l,\n          step = 0.1 / l; // step 2: fine check\n\n    let mdist = closest.mdist,\n        t = t1,\n        ft = t,\n        p;\n    mdist += 1;\n\n    for (let d; t < t2 + step; t += step) {\n      p = this.compute(t);\n      d = utils.dist(point, p);\n\n      if (d < mdist) {\n        mdist = d;\n        ft = t;\n      }\n    }\n\n    ft = ft < 0 ? 0 : ft > 1 ? 1 : ft;\n    p = this.compute(ft);\n    p.t = ft;\n    p.d = mdist;\n    return p;\n  }\n\n  get(t) {\n    return this.compute(t);\n  }\n\n  point(idx) {\n    return this.points[idx];\n  }\n\n  compute(t) {\n    if (this.ratios) {\n      return utils.computeWithRatios(t, this.points, this.ratios, this._3d);\n    }\n\n    return utils.compute(t, this.points, this._3d, this.ratios);\n  }\n\n  raise() {\n    const p = this.points,\n          np = [p[0]],\n          k = p.length;\n\n    for (let i = 1, pi, pim; i < k; i++) {\n      pi = p[i];\n      pim = p[i - 1];\n      np[i] = {\n        x: (k - i) / k * pi.x + i / k * pim.x,\n        y: (k - i) / k * pi.y + i / k * pim.y\n      };\n    }\n\n    np[k] = p[k - 1];\n    return new Bezier(np);\n  }\n\n  derivative(t) {\n    return utils.compute(t, this.dpoints[0], this._3d);\n  }\n\n  dderivative(t) {\n    return utils.compute(t, this.dpoints[1], this._3d);\n  }\n\n  align() {\n    let p = this.points;\n    return new Bezier(utils.align(p, {\n      p1: p[0],\n      p2: p[p.length - 1]\n    }));\n  }\n\n  curvature(t) {\n    return utils.curvature(t, this.dpoints[0], this.dpoints[1], this._3d);\n  }\n\n  inflections() {\n    return utils.inflections(this.points);\n  }\n\n  normal(t) {\n    return this._3d ? this.__normal3(t) : this.__normal2(t);\n  }\n\n  __normal2(t) {\n    const d = this.derivative(t);\n    const q = sqrt$1(d.x * d.x + d.y * d.y);\n    return {\n      x: -d.y / q,\n      y: d.x / q\n    };\n  }\n\n  __normal3(t) {\n    // see http://stackoverflow.com/questions/25453159\n    const r1 = this.derivative(t),\n          r2 = this.derivative(t + 0.01),\n          q1 = sqrt$1(r1.x * r1.x + r1.y * r1.y + r1.z * r1.z),\n          q2 = sqrt$1(r2.x * r2.x + r2.y * r2.y + r2.z * r2.z);\n    r1.x /= q1;\n    r1.y /= q1;\n    r1.z /= q1;\n    r2.x /= q2;\n    r2.y /= q2;\n    r2.z /= q2; // cross product\n\n    const c = {\n      x: r2.y * r1.z - r2.z * r1.y,\n      y: r2.z * r1.x - r2.x * r1.z,\n      z: r2.x * r1.y - r2.y * r1.x\n    };\n    const m = sqrt$1(c.x * c.x + c.y * c.y + c.z * c.z);\n    c.x /= m;\n    c.y /= m;\n    c.z /= m; // rotation matrix\n\n    const R = [c.x * c.x, c.x * c.y - c.z, c.x * c.z + c.y, c.x * c.y + c.z, c.y * c.y, c.y * c.z - c.x, c.x * c.z - c.y, c.y * c.z + c.x, c.z * c.z]; // normal vector:\n\n    const n = {\n      x: R[0] * r1.x + R[1] * r1.y + R[2] * r1.z,\n      y: R[3] * r1.x + R[4] * r1.y + R[5] * r1.z,\n      z: R[6] * r1.x + R[7] * r1.y + R[8] * r1.z\n    };\n    return n;\n  }\n\n  hull(t) {\n    let p = this.points,\n        _p = [],\n        q = [],\n        idx = 0;\n    q[idx++] = p[0];\n    q[idx++] = p[1];\n    q[idx++] = p[2];\n\n    if (this.order === 3) {\n      q[idx++] = p[3];\n    } // we lerp between all points at each iteration, until we have 1 point left.\n\n\n    while (p.length > 1) {\n      _p = [];\n\n      for (let i = 0, pt, l = p.length - 1; i < l; i++) {\n        pt = utils.lerp(t, p[i], p[i + 1]);\n        q[idx++] = pt;\n\n        _p.push(pt);\n      }\n\n      p = _p;\n    }\n\n    return q;\n  }\n\n  split(t1, t2) {\n    // shortcuts\n    if (t1 === 0 && !!t2) {\n      return this.split(t2).left;\n    }\n\n    if (t2 === 1) {\n      return this.split(t1).right;\n    } // no shortcut: use \"de Casteljau\" iteration.\n\n\n    const q = this.hull(t1);\n    const result = {\n      left: this.order === 2 ? new Bezier([q[0], q[3], q[5]]) : new Bezier([q[0], q[4], q[7], q[9]]),\n      right: this.order === 2 ? new Bezier([q[5], q[4], q[2]]) : new Bezier([q[9], q[8], q[6], q[3]]),\n      span: q\n    }; // make sure we bind _t1/_t2 information!\n\n    result.left._t1 = utils.map(0, 0, 1, this._t1, this._t2);\n    result.left._t2 = utils.map(t1, 0, 1, this._t1, this._t2);\n    result.right._t1 = utils.map(t1, 0, 1, this._t1, this._t2);\n    result.right._t2 = utils.map(1, 0, 1, this._t1, this._t2); // if we have no t2, we're done\n\n    if (!t2) {\n      return result;\n    } // if we have a t2, split again:\n\n\n    t2 = utils.map(t2, t1, 1, 0, 1);\n    return result.right.split(t2).left;\n  }\n\n  extrema() {\n    const result = {};\n    let roots = [];\n    this.dims.forEach(function (dim) {\n      let mfn = function (v) {\n        return v[dim];\n      };\n\n      let p = this.dpoints[0].map(mfn);\n      result[dim] = utils.droots(p);\n\n      if (this.order === 3) {\n        p = this.dpoints[1].map(mfn);\n        result[dim] = result[dim].concat(utils.droots(p));\n      }\n\n      result[dim] = result[dim].filter(function (t) {\n        return t >= 0 && t <= 1;\n      });\n      roots = roots.concat(result[dim].sort(utils.numberSort));\n    }.bind(this));\n    result.values = roots.sort(utils.numberSort).filter(function (v, idx) {\n      return roots.indexOf(v) === idx;\n    });\n    return result;\n  }\n\n  bbox() {\n    const extrema = this.extrema(),\n          result = {};\n    this.dims.forEach(function (d) {\n      result[d] = utils.getminmax(this, d, extrema[d]);\n    }.bind(this));\n    return result;\n  }\n\n  overlaps(curve) {\n    const lbbox = this.bbox(),\n          tbbox = curve.bbox();\n    return utils.bboxoverlap(lbbox, tbbox);\n  }\n\n  offset(t, d) {\n    if (typeof d !== \"undefined\") {\n      const c = this.get(t),\n            n = this.normal(t);\n      const ret = {\n        c: c,\n        n: n,\n        x: c.x + n.x * d,\n        y: c.y + n.y * d\n      };\n\n      if (this._3d) {\n        ret.z = c.z + n.z * d;\n      }\n\n      return ret;\n    }\n\n    if (this._linear) {\n      const nv = this.normal(0),\n            coords = this.points.map(function (p) {\n        const ret = {\n          x: p.x + t * nv.x,\n          y: p.y + t * nv.y\n        };\n\n        if (p.z && nv.z) {\n          ret.z = p.z + t * nv.z;\n        }\n\n        return ret;\n      });\n      return [new Bezier(coords)];\n    }\n\n    return this.reduce().map(function (s) {\n      if (s._linear) {\n        return s.offset(t)[0];\n      }\n\n      return s.scale(t);\n    });\n  }\n\n  simple() {\n    if (this.order === 3) {\n      const a1 = utils.angle(this.points[0], this.points[3], this.points[1]);\n      const a2 = utils.angle(this.points[0], this.points[3], this.points[2]);\n      if (a1 > 0 && a2 < 0 || a1 < 0 && a2 > 0) return false;\n    }\n\n    const n1 = this.normal(0);\n    const n2 = this.normal(1);\n    let s = n1.x * n2.x + n1.y * n2.y;\n\n    if (this._3d) {\n      s += n1.z * n2.z;\n    }\n\n    return abs$1(acos$1(s)) < pi$1 / 3;\n  }\n\n  reduce() {\n    // TODO: examine these var types in more detail...\n    let i,\n        t1 = 0,\n        t2 = 0,\n        step = 0.01,\n        segment,\n        pass1 = [],\n        pass2 = []; // first pass: split on extrema\n\n    let extrema = this.extrema().values;\n\n    if (extrema.indexOf(0) === -1) {\n      extrema = [0].concat(extrema);\n    }\n\n    if (extrema.indexOf(1) === -1) {\n      extrema.push(1);\n    }\n\n    for (t1 = extrema[0], i = 1; i < extrema.length; i++) {\n      t2 = extrema[i];\n      segment = this.split(t1, t2);\n      segment._t1 = t1;\n      segment._t2 = t2;\n      pass1.push(segment);\n      t1 = t2;\n    } // second pass: further reduce these segments to simple segments\n\n\n    pass1.forEach(function (p1) {\n      t1 = 0;\n      t2 = 0;\n\n      while (t2 <= 1) {\n        for (t2 = t1 + step; t2 <= 1 + step; t2 += step) {\n          segment = p1.split(t1, t2);\n\n          if (!segment.simple()) {\n            t2 -= step;\n\n            if (abs$1(t1 - t2) < step) {\n              // we can never form a reduction\n              return [];\n            }\n\n            segment = p1.split(t1, t2);\n            segment._t1 = utils.map(t1, 0, 1, p1._t1, p1._t2);\n            segment._t2 = utils.map(t2, 0, 1, p1._t1, p1._t2);\n            pass2.push(segment);\n            t1 = t2;\n            break;\n          }\n        }\n      }\n\n      if (t1 < 1) {\n        segment = p1.split(t1, 1);\n        segment._t1 = utils.map(t1, 0, 1, p1._t1, p1._t2);\n        segment._t2 = p1._t2;\n        pass2.push(segment);\n      }\n    });\n    return pass2;\n  }\n\n  translate(v, d1, d2) {\n    d2 = typeof d2 === \"number\" ? d2 : d1; // TODO: make this take curves with control points outside\n    //       of the start-end interval into account\n\n    const o = this.order;\n    let d = this.points.map((_, i) => (1 - i / o) * d1 + i / o * d2);\n    return new Bezier(this.points.map((p, i) => ({\n      x: p.x + v.x * d[i],\n      y: p.y + v.y * d[i]\n    })));\n  }\n\n  scale(d) {\n    const order = this.order;\n    let distanceFn = false;\n\n    if (typeof d === \"function\") {\n      distanceFn = d;\n    }\n\n    if (distanceFn && order === 2) {\n      return this.raise().scale(distanceFn);\n    } // TODO: add special handling for non-linear degenerate curves.\n\n\n    const clockwise = this.clockwise;\n    const points = this.points;\n\n    if (this._linear) {\n      return this.translate(this.normal(0), distanceFn ? distanceFn(0) : d, distanceFn ? distanceFn(1) : d);\n    }\n\n    const r1 = distanceFn ? distanceFn(0) : d;\n    const r2 = distanceFn ? distanceFn(1) : d;\n    const v = [this.offset(0, 10), this.offset(1, 10)];\n    const np = [];\n    const o = utils.lli4(v[0], v[0].c, v[1], v[1].c);\n\n    if (!o) {\n      throw new Error(\"cannot scale this curve. Try reducing it first.\");\n    } // move all points by distance 'd' wrt the origin 'o',\n    // and move end points by fixed distance along normal.\n\n\n    [0, 1].forEach(function (t) {\n      const p = np[t * order] = utils.copy(points[t * order]);\n      p.x += (t ? r2 : r1) * v[t].n.x;\n      p.y += (t ? r2 : r1) * v[t].n.y;\n    });\n\n    if (!distanceFn) {\n      // move control points to lie on the intersection of the offset\n      // derivative vector, and the origin-through-control vector\n      [0, 1].forEach(t => {\n        if (order === 2 && !!t) return;\n        const p = np[t * order];\n        const d = this.derivative(t);\n        const p2 = {\n          x: p.x + d.x,\n          y: p.y + d.y\n        };\n        np[t + 1] = utils.lli4(p, p2, o, points[t + 1]);\n      });\n      return new Bezier(np);\n    } // move control points by \"however much necessary to\n    // ensure the correct tangent to endpoint\".\n\n\n    [0, 1].forEach(function (t) {\n      if (order === 2 && !!t) return;\n      var p = points[t + 1];\n      var ov = {\n        x: p.x - o.x,\n        y: p.y - o.y\n      };\n      var rc = distanceFn ? distanceFn((t + 1) / order) : d;\n      if (distanceFn && !clockwise) rc = -rc;\n      var m = sqrt$1(ov.x * ov.x + ov.y * ov.y);\n      ov.x /= m;\n      ov.y /= m;\n      np[t + 1] = {\n        x: p.x + rc * ov.x,\n        y: p.y + rc * ov.y\n      };\n    });\n    return new Bezier(np);\n  }\n\n  outline(d1, d2, d3, d4) {\n    d2 = d2 === undefined ? d1 : d2;\n\n    if (this._linear) {\n      // TODO: find the actual extrema, because they might\n      //       be before the start, or past the end.\n      const n = this.normal(0);\n      const start = this.points[0];\n      const end = this.points[this.points.length - 1];\n      let s, mid, e;\n\n      if (d3 === undefined) {\n        d3 = d1;\n        d4 = d2;\n      }\n\n      s = {\n        x: start.x + n.x * d1,\n        y: start.y + n.y * d1\n      };\n      e = {\n        x: end.x + n.x * d3,\n        y: end.y + n.y * d3\n      };\n      mid = {\n        x: (s.x + e.x) / 2,\n        y: (s.y + e.y) / 2\n      };\n      const fline = [s, mid, e];\n      s = {\n        x: start.x - n.x * d2,\n        y: start.y - n.y * d2\n      };\n      e = {\n        x: end.x - n.x * d4,\n        y: end.y - n.y * d4\n      };\n      mid = {\n        x: (s.x + e.x) / 2,\n        y: (s.y + e.y) / 2\n      };\n      const bline = [e, mid, s];\n      const ls = utils.makeline(bline[2], fline[0]);\n      const le = utils.makeline(fline[2], bline[0]);\n      const segments = [ls, new Bezier(fline), le, new Bezier(bline)];\n      return new PolyBezier(segments);\n    }\n\n    const reduced = this.reduce(),\n          len = reduced.length,\n          fcurves = [];\n    let bcurves = [],\n        p,\n        alen = 0,\n        tlen = this.length();\n    const graduated = typeof d3 !== \"undefined\" && typeof d4 !== \"undefined\";\n\n    function linearDistanceFunction(s, e, tlen, alen, slen) {\n      return function (v) {\n        const f1 = alen / tlen,\n              f2 = (alen + slen) / tlen,\n              d = e - s;\n        return utils.map(v, 0, 1, s + f1 * d, s + f2 * d);\n      };\n    } // form curve oulines\n\n\n    reduced.forEach(function (segment) {\n      const slen = segment.length();\n\n      if (graduated) {\n        fcurves.push(segment.scale(linearDistanceFunction(d1, d3, tlen, alen, slen)));\n        bcurves.push(segment.scale(linearDistanceFunction(-d2, -d4, tlen, alen, slen)));\n      } else {\n        fcurves.push(segment.scale(d1));\n        bcurves.push(segment.scale(-d2));\n      }\n\n      alen += slen;\n    }); // reverse the \"return\" outline\n\n    bcurves = bcurves.map(function (s) {\n      p = s.points;\n\n      if (p[3]) {\n        s.points = [p[3], p[2], p[1], p[0]];\n      } else {\n        s.points = [p[2], p[1], p[0]];\n      }\n\n      return s;\n    }).reverse(); // form the endcaps as lines\n\n    const fs = fcurves[0].points[0],\n          fe = fcurves[len - 1].points[fcurves[len - 1].points.length - 1],\n          bs = bcurves[len - 1].points[bcurves[len - 1].points.length - 1],\n          be = bcurves[0].points[0],\n          ls = utils.makeline(bs, fs),\n          le = utils.makeline(fe, be),\n          segments = [ls].concat(fcurves).concat([le]).concat(bcurves);\n    return new PolyBezier(segments);\n  }\n\n  outlineshapes(d1, d2, curveIntersectionThreshold) {\n    d2 = d2 || d1;\n    const outline = this.outline(d1, d2).curves;\n    const shapes = [];\n\n    for (let i = 1, len = outline.length; i < len / 2; i++) {\n      const shape = utils.makeshape(outline[i], outline[len - i], curveIntersectionThreshold);\n      shape.startcap.virtual = i > 1;\n      shape.endcap.virtual = i < len / 2 - 1;\n      shapes.push(shape);\n    }\n\n    return shapes;\n  }\n\n  intersects(curve, curveIntersectionThreshold) {\n    if (!curve) return this.selfintersects(curveIntersectionThreshold);\n\n    if (curve.p1 && curve.p2) {\n      return this.lineIntersects(curve);\n    }\n\n    if (curve instanceof Bezier) {\n      curve = curve.reduce();\n    }\n\n    return this.curveintersects(this.reduce(), curve, curveIntersectionThreshold);\n  }\n\n  lineIntersects(line) {\n    const mx = min(line.p1.x, line.p2.x),\n          my = min(line.p1.y, line.p2.y),\n          MX = max(line.p1.x, line.p2.x),\n          MY = max(line.p1.y, line.p2.y);\n    return utils.roots(this.points, line).filter(t => {\n      var p = this.get(t);\n      return utils.between(p.x, mx, MX) && utils.between(p.y, my, MY);\n    });\n  }\n\n  selfintersects(curveIntersectionThreshold) {\n    // \"simple\" curves cannot intersect with their direct\n    // neighbour, so for each segment X we check whether\n    // it intersects [0:x-2][x+2:last].\n    const reduced = this.reduce(),\n          len = reduced.length - 2,\n          results = [];\n\n    for (let i = 0, result, left, right; i < len; i++) {\n      left = reduced.slice(i, i + 1);\n      right = reduced.slice(i + 2);\n      result = this.curveintersects(left, right, curveIntersectionThreshold);\n      results.push(...result);\n    }\n\n    return results;\n  }\n\n  curveintersects(c1, c2, curveIntersectionThreshold) {\n    const pairs = []; // step 1: pair off any overlapping segments\n\n    c1.forEach(function (l) {\n      c2.forEach(function (r) {\n        if (l.overlaps(r)) {\n          pairs.push({\n            left: l,\n            right: r\n          });\n        }\n      });\n    }); // step 2: for each pairing, run through the convergence algorithm.\n\n    let intersections = [];\n    pairs.forEach(function (pair) {\n      const result = utils.pairiteration(pair.left, pair.right, curveIntersectionThreshold);\n\n      if (result.length > 0) {\n        intersections = intersections.concat(result);\n      }\n    });\n    return intersections;\n  }\n\n  arcs(errorThreshold) {\n    errorThreshold = errorThreshold || 0.5;\n    return this._iterate(errorThreshold, []);\n  }\n\n  _error(pc, np1, s, e) {\n    const q = (e - s) / 4,\n          c1 = this.get(s + q),\n          c2 = this.get(e - q),\n          ref = utils.dist(pc, np1),\n          d1 = utils.dist(pc, c1),\n          d2 = utils.dist(pc, c2);\n    return abs$1(d1 - ref) + abs$1(d2 - ref);\n  }\n\n  _iterate(errorThreshold, circles) {\n    let t_s = 0,\n        t_e = 1,\n        safety; // we do a binary search to find the \"good `t` closest to no-longer-good\"\n\n    do {\n      safety = 0; // step 1: start with the maximum possible arc\n\n      t_e = 1; // points:\n\n      let np1 = this.get(t_s),\n          np2,\n          np3,\n          arc,\n          prev_arc; // booleans:\n\n      let curr_good = false,\n          prev_good = false,\n          done; // numbers:\n\n      let t_m = t_e,\n          prev_e = 1; // step 2: find the best possible arc\n\n      do {\n        prev_good = curr_good;\n        prev_arc = arc;\n        t_m = (t_s + t_e) / 2;\n        np2 = this.get(t_m);\n        np3 = this.get(t_e);\n        arc = utils.getccenter(np1, np2, np3); //also save the t values\n\n        arc.interval = {\n          start: t_s,\n          end: t_e\n        };\n\n        let error = this._error(arc, np1, t_s, t_e);\n\n        curr_good = error <= errorThreshold;\n        done = prev_good && !curr_good;\n        if (!done) prev_e = t_e; // this arc is fine: we can move 'e' up to see if we can find a wider arc\n\n        if (curr_good) {\n          // if e is already at max, then we're done for this arc.\n          if (t_e >= 1) {\n            // make sure we cap at t=1\n            arc.interval.end = prev_e = 1;\n            prev_arc = arc; // if we capped the arc segment to t=1 we also need to make sure that\n            // the arc's end angle is correct with respect to the bezier end point.\n\n            if (t_e > 1) {\n              let d = {\n                x: arc.x + arc.r * cos$1(arc.e),\n                y: arc.y + arc.r * sin$1(arc.e)\n              };\n              arc.e += utils.angle({\n                x: arc.x,\n                y: arc.y\n              }, d, this.get(1));\n            }\n\n            break;\n          } // if not, move it up by half the iteration distance\n\n\n          t_e = t_e + (t_e - t_s) / 2;\n        } else {\n          // this is a bad arc: we need to move 'e' down to find a good arc\n          t_e = t_m;\n        }\n      } while (!done && safety++ < 100);\n\n      if (safety >= 100) {\n        break;\n      } // console.log(\"L835: [F] arc found\", t_s, prev_e, prev_arc.x, prev_arc.y, prev_arc.s, prev_arc.e);\n\n\n      prev_arc = prev_arc ? prev_arc : arc;\n      circles.push(prev_arc);\n      t_s = prev_e;\n    } while (t_e < 1);\n\n    return circles;\n  }\n\n}\n\nexports.Bezier = Bezier;\n","// Module\nvar code = \"<div class=\\\"ease-gui mode-select\\\">\\n    <div class=\\\"header\\\">\\n        <div class=\\\"property-name\\\"></div>\\n        <div class=\\\"c\\\">\\n            <div class=\\\"ease-selector\\\">\\n                <div class=\\\"corner-curve-container\\\">\\n                    <div class=\\\"ratio-box\\\">\\n                        <div class=\\\"ratio-box-inner\\\">\\n                            <canvas class=\\\"corner-curve\\\"></canvas>\\n                        </div>\\n                    </div>\\n                </div>\\n\\n                <div class=\\\"template-selector\\\">\\n                    <div class=\\\"curve-selector-container\\\">\\n                        <select class=\\\"curve-selector\\\" dir=\\\"rtl\\\"></select>\\n                    </div>\\n                    <div class=\\\"orientation-selector-container\\\">\\n                        <select class=\\\"orientation-selector\\\"></select>\\n                    </div>\\n                    <div class=\\\"edit-button-container\\\">\\n                        <svg class=\\\"edit-button\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" height=\\\"18px\\\" viewBox=\\\"0 0 24 24\\\" width=\\\"18px\\\" fill=\\\"#606060\\\"><path d=\\\"M0 0h24v24H0z\\\" fill=\\\"none\\\"/><path d=\\\"M19.5 9.5c-1.03 0-1.9.62-2.29 1.5h-2.92c-.39-.88-1.26-1.5-2.29-1.5s-1.9.62-2.29 1.5H6.79c-.39-.88-1.26-1.5-2.29-1.5C3.12 9.5 2 10.62 2 12s1.12 2.5 2.5 2.5c1.03 0 1.9-.62 2.29-1.5h2.92c.39.88 1.26 1.5 2.29 1.5s1.9-.62 2.29-1.5h2.92c.39.88 1.26 1.5 2.29 1.5 1.38 0 2.5-1.12 2.5-2.5s-1.12-2.5-2.5-2.5z\\\"/></svg>\\n                    </div>\\n                </div>\\n            </div>\\n        </div>\\n    </div>\\n    <div class=\\\"properties-container\\\">\\n        <!-- procedurally injected elements -->\\n    </div>\\n    <div class=\\\"editor-container\\\">\\n        <div class=\\\"ratio-box\\\">\\n            <div class=\\\"ratio-box-inner\\\">\\n                <canvas class=\\\"editor\\\"></canvas>\\n            </div>\\n        </div>\\n        <div class=\\\"path-selector-container\\\">\\n            <input type=\\\"text\\\" class=\\\"path-selector\\\" onclick=\\\"this.select();\\\" value=\\\"M0,0 C20, 23,123\\\" />\\n            <div class=\\\"copy-button-container\\\">\\n                <svg class=\\\"copy-button\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" height=\\\"18px\\\" viewBox=\\\"0 0 24 24\\\" width=\\\"18px\\\" fill=\\\"#606060\\\"><path d=\\\"M0 0h24v24H0V0z\\\" fill=\\\"none\\\"/><path d=\\\"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z\\\"/></svg>\\n            </div>\\n        </div>\\n        <div class=\\\"editor-buttons\\\">\\n            <div class=\\\"decline-button\\\">\\n                <div class=\\\"icon-container\\\">\\n                    <svg class=\\\"icon\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" height=\\\"24px\\\" viewBox=\\\"0 0 24 24\\\" width=\\\"24px\\\" fill=\\\"#c93333\\\"><path d=\\\"M0 0h24v24H0V0z\\\" fill=\\\"none\\\"/><path d=\\\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z\\\"/></svg>\\n                </div>\\n                <div class=\\\"label-container\\\">\\n                    <div class=\\\"label\\\">DISCARD</div>\\n                </div>\\n            </div>\\n            <div class=\\\"accept-button\\\">\\n                <div class=\\\"label-container\\\">\\n                    <div class=\\\"label\\\">ACCEPT</div>\\n                </div>\\n                <div class=\\\"icon-container\\\">\\n                    <svg class=\\\"icon\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" height=\\\"24px\\\" viewBox=\\\"0 0 24 24\\\" width=\\\"24px\\\" fill=\\\"#84be18\\\"><path d=\\\"M0 0h24v24H0V0z\\\" fill=\\\"none\\\"/><path d=\\\"M9 16.2l-3.5-3.5c-.39-.39-1.01-.39-1.4 0-.39.39-.39 1.01 0 1.4l4.19 4.19c.39.39 1.02.39 1.41 0L20.3 7.7c.39-.39.39-1.01 0-1.4-.39-.39-1.01-.39-1.4 0L9 16.2z\\\"/></svg>\\n                </div>\\n            </div>\\n        </div>\\n    </div>\\n    <div>\\n        \\n    </div>\\n</div>\";\n// Exports\nexport default code;","// Module\nvar code = \"<li class=\\\"cr\\\" style=\\\"border-left: none\\\">\\n    <div>\\n        <span class=\\\"property-name\\\"><!-- procedurally injected name --></span>\\n        <div class=\\\"c\\\"><!-- procedurally injected control --></div>\\n    </div>\\n</li>\";\n// Exports\nexport default code;","// extracted by mini-css-extract-plugin\nexport {};","module.exports = __WEBPACK_EXTERNAL_MODULE_dat_gui__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/index.js\");\n"],"sourceRoot":""}